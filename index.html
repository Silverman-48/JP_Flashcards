<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JP Flashcards</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 30px; background-color: #f4f4f9; }
        
        /* --- Shared Elements --- */
        #promptDisplay { font-size: 50px; margin: 20px; color: #333; font-family: "MS PGothic", sans-serif; min-height: 50px; }
        #meaningDisplay { font-size: 22px; margin-bottom: 20px; color: #555; font-weight: bold; min-height: 22px; }
        input[type="text"] { font-size: 20px; padding: 10px; width: 230px; text-align: center; border: 2px solid #ccc; border-radius: 5px; }
        button { font-size: 16px; margin: 5px; padding: 8px 15px; border-radius: 5px; border: none; cursor: pointer; background: #5c67f2; color: white; transition: background-color 0.2s; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        button:hover { background: #5c67f2; border: none; color: white; }

        #correctBtn { background: #28a745; }
        #incorrectBtn { background: #dc3545; }
        #correctBtn:disabled { background: #ccc; cursor: not-allowed; }
        #incorrectBtn:disabled { background: #ccc; cursor: not-allowed; }
        #correctBtn:hover { background: #28a745; border: none; color: white; }
        #incorrectBtn:hover { background: #dc3545; border: none; color: white; }
        
        #resetBtn { background: #f25c5c; }
        #resetBtn:hover { background: #f25c5c; border: none; color: white; }
        
        .stats { margin-top: 15px; margin-bottom: 15px; font-size: 18px; color: #555; }
        #resultDisplay { margin-top: 15px; font-size: 20px; font-weight: bold; height: 20px; }
        .neutral { color: black; }
        .correct { color: green; }
        .incorrect { color: red; }

        /* --- Mode Selection --- */
        .mode-choice { font-size: 1.2em; padding-bottom: 15px; }
        .mode-choice label { margin: 0 15px; cursor: pointer; }
        .sub-options { margin-top: 20px; }

        /* --- Vocabulary Mode Specific --- */
        .word-list-container {
            max-height: 400px;
            max-width: 300px;
            overflow-y: auto;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 15px;
            margin: 25px auto;
            text-align: left;
            background-color: #fff;
            display: none; 
        }
        .word-list-container h3 { margin-top: 0; text-align: center; }
        .word-list-container p { border-bottom: 1px solid #eee; padding-bottom: 5px; margin: 0 0 5px 0; }
        
        /* --- Kana Mode Specific --- */
        .groups-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .groups { text-align: left; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background-color: #fff; }
        .groups h3, .groups h4 { margin-top: 0; margin-bottom: 10px; }
        .groups label { display: block; margin: 3px 0; cursor: pointer;}
    </style>
</head>
<body>
    
    <div class="mode-choice" style="line-height: 1.5">
        <label><input type="radio" name="appMode" value="kana" checked> Kana</label>
        <label><input type="radio" name="appMode" value="vocab"> Vocabulário</label>
        <br>
        <label><input type="radio" name="appMode" value="random"> Aleatório</label>
    </div>

    <div id="meaningDisplay">...</div>
    <div id="promptDisplay">?</div>
    <input type="text" id="answerBox" placeholder="Digite a leitura...">
    <div id="resultDisplay">Aguardando Resposta...</div><br>
    
    <button id="checkBtn">Verificar</button>
    <button id="nextBtn">Seguinte</button>
    <button id="correctBtn" style="display: none;">Correto</button>
    <button id="incorrectBtn" style="display: none;">Incorreto</button>
    <button id="resetBtn">Reiniciar</button>
    
    <div class="stats">
        Restantes: <span id="remainingCount">0</span><br>
        <span id="answerCounters">Corretos: <span id="correctCount">0</span> | Incorretos: <span id="incorrectCount">0</span></span>
    </div>

    <div id="kana-controls" class="sub-options">
        <div class="mode-choice">
            <label><input type="radio" name="kanaScript" value="normal" checked> Normal</label>
            <label><input type="radio" name="kanaScript" value="reverse"> Inverso</label>
        </div>
        <button id="showAllBtn2">Lista de Kana</button>
        <button id="optionsBtn2">Opções</button>
        <div id="allWordsContainer2" class="word-list-container"></div>
        <div class="groups-container" id="options2" style="display: none">
            <div class="groups">
                <h3>Hiragana</h3>
                <h4><label><input type="checkbox" id="checkAllHira" checked> Ativar/Desativar Todas</label></h4>
                <hr>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpA" checked> Linha A</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpKA" checked> Linha KA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpSA" checked> Linha SA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpTA" checked> Linha TA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpNA" checked> Linha NA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpHA" checked> Linha HA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpMA" checked> Linha MA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpYA" checked> Linha YA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpRA" checked> Linha RA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpWA" checked> Linha WA/N</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpGA" checked> Som Sonoro GA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpZA" checked> Som Sonoro ZA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpDA" checked> Som Sonoro DA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpBA" checked> Som Sonoro BA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpPA" checked> Som Semissonoro PA</label>
                <label><input type="checkbox" class="group-checkbox-hira" id="grpYOON" checked> Ditongos</label>
            </div>
            <div class="groups">
                <h3>Katakana</h3>
                <h4><label><input type="checkbox" id="checkAllKata" checked> Ativar/Desativar Todas</label></h4>
                <hr>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpA_kata" checked> Linha A</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpKA_kata" checked> Linha KA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpSA_kata" checked> Linha SA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpTA_kata" checked> Linha TA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpNA_kata" checked> Linha NA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpHA_kata" checked> Linha HA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpMA_kata" checked> Linha MA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpYA_kata" checked> Linha YA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpRA_kata" checked> Linha RA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpWA_kata" checked> Linha WA/N</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpGA_kata" checked> Som Sonoro GA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpZA_kata" checked> Som Sonoro ZA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpDA_kata" checked> Som Sonoro DA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpBA_kata" checked> Som Sonoro BA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpPA_kata" checked> Som Semissonoro PA</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpYOON_kata" checked> Ditongos</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpSPE_1_kata" checked> Sons Especiais 1</label>
                <label><input type="checkbox" class="group-checkbox-kata" id="grpSPE_2_kata" checked> Sons Especiais 2</label>
            </div>
        </div>
    </div>

    <div id="vocab-controls" class="sub-options">
        <div class="mode-choice">
            <label><input type="radio" name="vocabScript" value="normal" checked> Normal</label>
            <label><input type="radio" name="vocabScript" value="alt"> Inverso</label>
        </div>
        <button id="showAllBtn1">Lista de Palavras</button>
        <button id="optionsBtn1">Opções</button>
        <div id="allWordsContainer1" class="word-list-container"></div>
        <div class="groups-container" id="options1" style="display: none">
            <div class="groups">
                <h3>Hiragana</h3>
                <h4><label><input type="checkbox" id="checkAllWordsHira" checked> Ativar/Desativar Todas</label></h4>
                <hr>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL01" checked> Lição 1 - Linha A</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL02" checked> Lição 2 - Linha KA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL03" checked> Lição 3 - Linha SA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL04" checked> Lição 4 - Linha TA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL05" checked> Lição 5 - Linha NA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL06" checked> Lição 6 - Linha HA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL07" checked> Lição 7 - Linha MA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL08" checked> Lição 8 - Linha YA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL09" checked> Lição 9 - Linha RA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL10" checked> Lição 10 - Linha WA/N</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL11" checked> Lição 11 - Som Sonoro GA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL12" checked> Lição 12 - Som Sonoro ZA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL13" checked> Lição 13 - Som Sonoro DA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL14" checked> Lição 14 - Som Sonoro BA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL15" checked> Lição 15 - Som Semissonoro PA</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL16" checked> Lição 16 - Som Oclusivo</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL17" checked> Lição 17 - Som Longo</label>
                <label><input type="checkbox" class="group-checkbox-words-hira" id="wrdL18" checked> Lição 18 - Ditongo</label>
            </div>
            <div class="groups">
                <h3>Katakana</h3>
                <h4><label><input type="checkbox" id="checkAllWordsKata" checked> Ativar/Desativar Todas</label></h4>
                <hr>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL01_kata" checked> Lição 1 - Linha A</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL02_kata" checked> Lição 2 - Linha KA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL03_kata" checked> Lição 3 - Linha SA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL04_kata" checked> Lição 4 - Linha TA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL05_kata" checked> Lição 5 - Linha NA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL06_kata" checked> Lição 6 - Linha HA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL07_kata" checked> Lição 7 - Linha MA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL08_kata" checked> Lição 8 - Linha YA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL09_kata" checked> Lição 9 - Linha RA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL10_kata" checked> Lição 10 - Linha WA/N</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL11_kata" checked> Lição 11 - Som Sonoro GA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL12_kata" checked> Lição 12 - Som Sonoro ZA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL13_kata" checked> Lição 13 - Som Sonoro DA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL14_kata" checked> Lição 14 - Som Sonoro BA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL15_kata" checked> Lição 15 - Som Semissonoro PA</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL16_kata" checked> Lição 16 - Som Oclusivo</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL17_kata" checked> Lição 17 - Som Longo</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL18_kata" checked> Lição 18 - Ditongo</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL19_kata" checked> Lição 19 - Sons Especiais</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL20_1_kata" checked> Lição 20.1 - Países</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL20_2_kata" checked> Lição 20.2 - Nacionalidades</label>
                <label><input type="checkbox" class="group-checkbox-words-kata" id="wrdL20_3_kata" checked> Lição 20.3 - Línguas</label>
            </div>
        </div>
    </div>

<script>
    // ===== DATA FROM BOTH SCRIPTS =====
const hiraganaWords = {
L01:[{word:"あい",reading:"ai",meaning:"Amor"},
{word:"いえ",reading:"ie",meaning:"Casa"},
{word:"うえ",reading:"ue",meaning:"Acima (em cima, sobre)"},
{word:"え",reading:"e",meaning:"Desenho (pintura, imagem)"},
{word:"おおい",reading:"ooi",meaning:"Muito (quantificador)"},
{word:"あお",reading:"ao",meaning:"Azul"},
{word:"いい",reading:"ii",meaning:"Bom / Bem"},
{word:"あう",reading:"au",meaning:"Encontrar-se (com alguém)"}],

L02:[{word:"かお",reading:"kao",meaning:"Rosto (cara, face)"},
{word:"えき",reading:"eki",meaning:"Estação (de comboio)"},
{word:"きく",reading:"kiku",meaning:"Ouvir / Perguntar"},
{word:"いけ",reading:"ike",meaning:"Lagoa"},
{word:"こえ",reading:"koe",meaning:"Voz"},
{word:"あき",reading:"aki",meaning:"Outono"},
{word:"き",reading:"ki",meaning:"Árvore / Madeira"},
{word:"かく",reading:"kaku",meaning:"Escrever / Desenhar"}],

L03:[{word:"かさ",reading:"kasa",meaning:"Guarda-chuva"},
{word:"しお",reading:"shio",meaning:"Sal"},
{word:"いす",reading:"isu",meaning:"Cadeira"},
{word:"せかい",reading:"sekai",meaning:"Mundo"},
{word:"きそく",reading:"kisoku",meaning:"Regras"},
{word:"すいか",reading:"suika",meaning:"Melancia"},
{word:"おかし",reading:"okashi",meaning:"Doces (guloseima)"},
{word:"すし",reading:"sushi",meaning:"Sushi"}],

L04:[{word:"した",reading:"shita",meaning:"Abaixo (embaixo, sob)"},
{word:"くち",reading:"kuchi",meaning:"Boca"},
{word:"つくえ",reading:"tsukue",meaning:"Secretária (mesa)"},
{word:"て",reading:"te",meaning:"Mão"},
{word:"いと",reading:"ito",meaning:"Fio (linha)"},
{word:"たけ",reading:"take",meaning:"Bambu"},
{word:"とけい",reading:"tokei",meaning:"Relógio"},
{word:"くつ",reading:"kutsu",meaning:"Sapato"}],

L05:[{word:"なつ",reading:"natsu",meaning:"Verão"},
{word:"にし",reading:"nishi",meaning:"Oeste"},
{word:"いぬ",reading:"inu",meaning:"Cão (cachorro)"},
{word:"ねこ",reading:"neko",meaning:"Gato"},
{word:"きのこ",reading:"kinoko",meaning:"Cogumelo"},
{word:"さかな",reading:"sakana",meaning:"Peixe"},
{word:"おかね",reading:"okane",meaning:"Dinheiro"},
{word:"にく",reading:"niku",meaning:"Carne"}],

L06:[{word:"はこ",reading:"hako",meaning:"Caixa"},
{word:"ひ",reading:"hi",meaning:"Fogo / Dia"},
{word:"ふね",reading:"fune",meaning:"Barco (navio)"},
{word:"へそ",reading:"heso",meaning:"Umbigo"},
{word:"ほし",reading:"hoshi",meaning:"Estrela"},
{word:"はな",reading:"hana",meaning:"Flor / Nariz"},
{word:"ふく",reading:"fuku",meaning:"Roupas"},
{word:"はち",reading:"hachi",meaning:"Oito / Abelha"}],

L07:[{word:"まち",reading:"machi",meaning:"Cidade / Bairro"},
{word:"みみ",reading:"mimi",meaning:"Orelha"},
{word:"むし",reading:"mushi",meaning:"Inseto"},
{word:"め",reading:"me",meaning:"Olho"},
{word:"もも",reading:"momo",meaning:"Pêssego"},
{word:"あめ",reading:"ame",meaning:"Chuva / Rebuçado"},
{word:"くも",reading:"kumo",meaning:"Nuvem / Aranha"},
{word:"きもの",reading:"kimono",meaning:"Quimono"}],

L08:[{word:"やね",reading:"yane",meaning:"Telhado"},
{word:"ゆめ",reading:"yume",meaning:"Sonho"},
{word:"よやく",reading:"yoyaku",meaning:"Reserva / Agendamento"},
{word:"やま",reading:"yama",meaning:"Montanha"},
{word:"ゆき",reading:"yuki",meaning:"Neve"},
{word:"よむ",reading:"yomu",meaning:"Ler"},
{word:"やさい",reading:"yasai",meaning:"Legumes / Verduras"},
{word:"やすみ",reading:"yasumi",meaning:"Descanso (folga, feriado)"},
{word:"ゆかた",reading:"yukata",meaning:"Yukata (quimono de verão)"},
{word:"やくそく",reading:"yakusoku",meaning:"Promessa (compromisso)"}],

L09:[{word:"さくら",reading:"sakura",meaning:"Cerejeira (flor de cerejeira)"},
{word:"となり",reading:"tonari",meaning:"Vizinho (próximo)"},
{word:"くるま",reading:"kuruma",meaning:"Carro"},
{word:"れきし",reading:"rekishi",meaning:"História"},
{word:"おふろ",reading:"ofuro",meaning:"Banheira (p/ tomar banho)"},
{word:"きれい",reading:"kirei",meaning:"Bonito / Limpo"},
{word:"しろ",reading:"shiro",meaning:"Branco"},
{word:"くろ",reading:"kuro",meaning:"Preto"}],

L10:[{word:"わたし",reading:"watashi",meaning:"Eu"},
{word:"ほしをみる",reading:"hoshi o miru",meaning:"Ver as estrelas"},
{word:"ほんをよむ",reading:"hon o yomu",meaning:"Ler um livro"},
{word:"にほん",reading:"nihon",meaning:"Japão"},
{word:"わかめ",reading:"wakame",meaning:"Alga marinha"},
{word:"みかん",reading:"mikan",meaning:"Tangerina"},
{word:"わに",reading:"wani",meaning:"Crocodilo"},
{word:"かわ",reading:"kawa",meaning:"Rio / Pele"},
{word:"きん",reading:"kin",meaning:"Ouro"},
{word:"みなさん",reading:"minasan",meaning:"Todos (toda a gente)"}],

L11:[{word:"てがみ",reading:"tegami",meaning:"Carta"},
{word:"かぎ",reading:"kagi",meaning:"Chave"},
{word:"かぐ",reading:"kagu",meaning:"Móveis (de casa)"},
{word:"げんき",reading:"genki",meaning:"Saúde (bem-estar)"},
{word:"りんご",reading:"ringo",meaning:"Maçã"},
{word:"がいこく",reading:"gaikoku",meaning:"País estrangeiro"},
{word:"たまご",reading:"tamago",meaning:"Ovo"},
{word:"ごご",reading:"gogo",meaning:"Tarde (p.m.)"},
{word:"めがね",reading:"megane",meaning:"Óculos"},
{word:"ごはん",reading:"gohan",meaning:"Arroz cozido / Refeição"}],

L12:[{word:"かざん",reading:"kazan",meaning:"Vulcão"},
{word:"かんじ",reading:"kanji",meaning:"Caractere chinês"},
{word:"みず",reading:"mizu",meaning:"Água"},
{word:"かぜ",reading:"kaze",meaning:"Vento / Resfriado"},
{word:"かぞく",reading:"kazoku",meaning:"Família"},
{word:"ざんねん",reading:"zannen",meaning:"Lamentável (que pena)"},
{word:"じしん",reading:"jishin",meaning:"Terramoto"},
{word:"ぜんぜん",reading:"zenzen",meaning:"De jeito nenhum (negação)"},
{word:"じかん",reading:"jikan",meaning:"Tempo (duração)"},
{word:"ざつおん",reading:"zatsuon",meaning:"Ruído (som indesejado)"}],

L13:[{word:"ひだり",reading:"hidari",meaning:"Esquerda"},
{word:"はなぢ",reading:"hanaji",meaning:"Sangramento nasal"},
{word:"つづく",reading:"tsuzuku",meaning:"Continuar"},
{word:"でんわ",reading:"denwa",meaning:"Telefone"},
{word:"まど",reading:"mado",meaning:"Janela"},
{word:"だいがく",reading:"daigaku",meaning:"Universidade"},
{word:"でぐち",reading:"deguchi",meaning:"Saída"},
{word:"かたづけ",reading:"katazuke",meaning:"Organização (arrumação)"},
{word:"どこ",reading:"doko",meaning:"Onde (pron. interrogativo)"},
{word:"だいすき",reading:"daisuki",meaning:"Adorar (gostar muito)"}],

L14:[{word:"たばこ",reading:"tabako",meaning:"Cigarro"},
{word:"びん",reading:"bin",meaning:"Garrafa"},
{word:"しんぶん",reading:"shinbun",meaning:"Jornal"},
{word:"かべ",reading:"kabe",meaning:"Parede"},
{word:"ぼく",reading:"boku",meaning:"Eu (informal masculino)"},
{word:"ばんごはん",reading:"bangohan",meaning:"Jantar"},
{word:"ぶんか",reading:"bunka",meaning:"Cultura"},
{word:"べんり",reading:"benri",meaning:"Prático (conveniente)"},
{word:"ぼんさい",reading:"bonsai",meaning:"Bonsai (arbusto japonês)"},
{word:"ぶんがく",reading:"bungaku",meaning:"Literatura"}],

L15:[{word:"でんぱ",reading:"denpa",meaning:"Onda Eletromagnética"},
{word:"えんぴつ",reading:"enpitsu",meaning:"Lápis"},
{word:"てんぷら",reading:"tempura",meaning:"Tempura"},
{word:"ぺこぺこ",reading:"pekopeko",meaning:"Faminto (onom.)"},
{word:"さんぽ",reading:"sanpo",meaning:"Passeio"},
{word:"かんぱい",reading:"kanpai",meaning:"Saúde! (brinde ao beber)"},
{word:"ぴかぴか",reading:"pikapika",meaning:"Brilhante / Reluzente (onom.)"},
{word:"ぺらぺら",reading:"perapera",meaning:"Fluente em idioma (onom.)"},
{word:"ぱくぱく",reading:"pakupaku",meaning:"Comer rapidamente (onom.)"},
{word:"ぽかぽか",reading:"pokapoka",meaning:"Quente / Confortável (onom.)"}],

L16:[{word:"けっこん",reading:"kekkon",meaning:"Casamento"},
{word:"さっか",reading:"sakka",meaning:"Escritor (autor)"},
{word:"きっぷ",reading:"kippu",meaning:"Bilhete (de transporte)"},
{word:"しっぱい",reading:"shippai",meaning:"Falha (fracasso)"},
{word:"ざっし",reading:"zasshi",meaning:"Revista"},
{word:"きっさてん",reading:"kissaten",meaning:"Cafetaria (café)"},
{word:"きって",reading:"kitte",meaning:"Selo (postagem)"},
{word:"あさって",reading:"asatte",meaning:"Depois de amanhã"},
{word:"こっち",reading:"kocchi",meaning:"Por aqui (informal)"},
{word:"しっぽ",reading:"shippo",meaning:"Cauda (de animal)"}],

L17:[{word:"おじいさん",reading:"ojiisan",meaning:"Avô"},
{word:"おばあさん",reading:"obaasan",meaning:"Avó"},
{word:"おとうさん",reading:"otousan",meaning:"Pai"},
{word:"おかあさん",reading:"okaasan",meaning:"Mãe"},
{word:"おにいさん",reading:"oniisan",meaning:"Irmão mais velho"},
{word:"おねえさん",reading:"oneesan",meaning:"Irmã mais velha"},
{word:"おとうとさん",reading:"otoutosan",meaning:"Irmão mais novo"},
{word:"いもうとさん",reading:"imoutosan",meaning:"Irmã mais nova"},
{word:"せんせい",reading:"sensei",meaning:"Professor (mestre)"},
{word:"がくせい",reading:"gakusei",meaning:"Estudante (aluno)"},
{word:"おおきい",reading:"ookii",meaning:"Grande"},
{word:"ちいさい",reading:"chiisai",meaning:"Pequeno"},
{word:"こおり",reading:"koori",meaning:"Gelo"},
{word:"ぼうし",reading:"boushi",meaning:"Chapéu"},
{word:"ぞう",reading:"zou",meaning:"Elefante"},
{word:"ひこうき",reading:"hikouki",meaning:"Avião"}],

L18:[{word:"とうきょう",reading:"toukyou",meaning:"Tóquio"},
{word:"きょうと",reading:"kyouto",meaning:"Quioto"},
{word:"きょうしつ",reading:"kyoushitsu",meaning:"Sala de aula"},
{word:"べんきょう",reading:"benkyou",meaning:"Estudo"},
{word:"ぎゅうにゅう",reading:"gyuunyuu",meaning:"Leite (gado bovino)"},
{word:"でんしゃ",reading:"densha",meaning:"Comboio"},
{word:"じてんしゃ",reading:"jitensha",meaning:"Bicicleta"},
{word:"いしゃ",reading:"isha",meaning:"Médico"},
{word:"じしょ",reading:"jisho",meaning:"Dicionário"},
{word:"としょかん",reading:"toshokan",meaning:"Biblioteca"},
{word:"しょくどう",reading:"shokudou",meaning:"Refeitório (cantina)"},
{word:"じんじゃ",reading:"jinja",meaning:"Santuário xintoísta"},
{word:"じゅう",reading:"juu",meaning:"Dez"},
{word:"おちゃ",reading:"ocha",meaning:"Chá"},
{word:"ひゃく",reading:"hyaku",meaning:"Cem"},
{word:"さんびゃく",reading:"sanbyaku",meaning:"Trezentos"},
{word:"びょういん",reading:"byouin",meaning:"Hospital"},
{word:"ろっぴゃく",reading:"roppyaku",meaning:"Seiscentos"},
{word:"りゅうがく",reading:"ryuugaku",meaning:"Estudar no exterior"},
{word:"りょこう",reading:"ryokou",meaning:"Viagem"}]
};

const katakanaWords = {
    L01: [
        { word: "アイロン", reading: "airon", meaning: "Ferro de passar roupa" },
        { word: "インク", reading: "inku", meaning: "Tinta" },
        { word: "ウイスキー", reading: "uisukii", meaning: "Uísque" },
        { word: "エアコン", reading: "eakon", meaning: "Ar condicionado" },
        { word: "オムレツ", reading: "omuretsu", meaning: "Omelete" },
        { word: "アイス", reading: "aisu", meaning: "Gelado / Gelo" },
        { word: "アメリカ", reading: "amerika", meaning: "Estados Unidos" },
        { word: "イギリス", reading: "igirisu", meaning: "Reino Unido" }
    ],

    L02: [
        { word: "カラオケ", reading: "karaoke", meaning: "Karaoke" },
        { word: "キウイ", reading: "kiui", meaning: "Quivi (kiwi)" },
        { word: "ミルク", reading: "miruku", meaning: "Leite" },
        { word: "ケーキ", reading: "keeki", meaning: "Bolo" },
        { word: "コアラ", reading: "koara", meaning: "Coala" },
        { word: "カナダ", reading: "kanada", meaning: "Canadá" },
        { word: "クラス", reading: "kurasu", meaning: "Aula (classe)" },
        { word: "コンビニ", reading: "konbini", meaning: "Loja de conveniência" }
    ],

    L03: [
        { word: "サウナ", reading: "sauna", meaning: "Sauna" },
        { word: "タクシー", reading: "takushii", meaning: "Táxi" },
        { word: "スキー", reading: "sukii", meaning: "Esqui" },
        { word: "センター", reading: "sentaa", meaning: "Centro" },
        { word: "ソース", reading: "soosu", meaning: "Molho" },
        { word: "サーカス", reading: "saakasu", meaning: "Circo" },
        { word: "システム", reading: "shisutemu", meaning: "Sistema" },
        { word: "スタイル", reading: "sutairu", meaning: "Estilo" }
    ],

    L04: [
        { word: "タオル", reading: "taoru", meaning: "Toalha" },
        { word: "チキン", reading: "chikin", meaning: "Frango" },
        { word: "スーツ", reading: "suutsu", meaning: "Fato / Terno" },
        { word: "テスト", reading: "tesuto", meaning: "Teste (avaliação)" },
        { word: "トイレ", reading: "toire", meaning: "Toilet" },
        { word: "テキスト", reading: "tekisuto", meaning: "Texto" },
        { word: "トマト", reading: "tomato", meaning: "Tomate" },
        { word: "ツナ", reading: "tsuna", meaning: "Atum" }
    ],

    L05: [
        { word: "ナイフ", reading: "naifu", meaning: "Faca" },
        { word: "テニス", reading: "tenisu", meaning: "Ténis (desporto)" },
        { word: "カヌー", reading: "kanuu", meaning: "Canoa" },
        { word: "ネクタイ", reading: "nekutai", meaning: "Gravata" },
        { word: "ノート", reading: "nooto", meaning: "Caderno" },
        { word: "ネイル", reading: "neiru", meaning: "Unha / Manicure" },
        { word: "ナイス", reading: "naisu", meaning: "Fixe (legal, bom)" },
        { word: "アニメ", reading: "anime", meaning: "Anime (animação)" }
    ],

    L06: [
        { word: "ハンカチ", reading: "hankachi", meaning: "Lenço" },
        { word: "コーヒー", reading: "koohii", meaning: "Café" },
        { word: "フルーツ", reading: "furutsu", meaning: "Frutas" },
        { word: "ヘルシー", reading: "herushii", meaning: "Saudável" },
        { word: "ホテル", reading: "hoteru", meaning: "Hotel" },
        { word: "ハム", reading: "hamu", meaning: "Presunto" },
        { word: "ハート", reading: "haato", meaning: "Coração" },
        { word: "ヒーロー", reading: "hiiroo", meaning: "Herói" }
    ],

    L07: [
        { word: "マイク", reading: "maiku", meaning: "Microfone" },
        { word: "ミサイル", reading: "misairu", meaning: "Míssil" },
        { word: "クリーム", reading: "kuriimu", meaning: "Creme" },
        { word: "メモ", reading: "memo", meaning: "Anotação (nota, memorando)" },
        { word: "モニター", reading: "monitaa", meaning: "Monitor" },
        { word: "ママ", reading: "mama", meaning: "Mamãe (informal)" },
        { word: "マスク", reading: "masuku", meaning: "Máscara" },
        { word: "メロン", reading: "meron", meaning: "Melão" }
    ],

    L08: [
        { word: "タイヤ", reading: "taiya", meaning: "Pneu" },
        { word: "ユニホーム", reading: "yunihoomu", meaning: "Uniforme" },
        { word: "クレヨン", reading: "kureyon", meaning: "Lápiz de cera" },
        { word: "ヨガ", reading: "yoga", meaning: "Yoga" },
        { word: "ユーロ", reading: "yuuro", meaning: "Euro (moeda)" },
        { word: "ヤンキー", reading: "yankii", meaning: "Rebelde (delinquente)" },
        { word: "ユーモア", reading: "yuumoa", meaning: "Humor" },
        { word: "ヨーグルト", reading: "yooguruto", meaning: "Iogurte" },
        { word: "ヨーロッパ", reading: "yooroppa", meaning: "Europa" },
        { word: "ユニバーサル", reading: "yunibaasaru", meaning: "Universal" }
    ],

    L09: [
        { word: "カメラ", reading: "kamera", meaning: "Câmera" },
        { word: "リスト", reading: "risuto", meaning: "Lista" },
        { word: "ルール", reading: "ruuru", meaning: "Regra" },
        { word: "レモン", reading: "remon", meaning: "Limão" },
        { word: "ロイヤル", reading: "roiyaru", meaning: "Real (realeza)" },
        { word: "ランチ", reading: "ranchi", meaning: "Almoço" },
        { word: "レストラン", reading: "resutoran", meaning: "Restaurante" },
        { word: "レイアウト", reading: "reiauto", meaning: "Layout (disposição)" }
    ],

    L10: [
        { word: "ワイン", reading: "wain", meaning: "Vinho" },
        { word: "ハワイ", reading: "hawai", meaning: "Havaí" },
        { word: "ボタン", reading: "botan", meaning: "Botão" },
        { word: "ワーク", reading: "waaku", meaning: "Trabalho" },
        { word: "ランプ", reading: "ranpu", meaning: "Lâmpada" },
        { word: "ライオン", reading: "raion", meaning: "Leão" },
        { word: "ワクチン", reading: "wakuchin", meaning: "Vacina" },
        { word: "エンジン", reading: "enjin", meaning: "Motor" },
        { word: "ワイヤレス", reading: "waiyaresu", meaning: "Sem fio" },
        { word: "カメラマン", reading: "kameraman", meaning: "Fotógrafo" }
    ],

    L11: [
        { word: "ガス", reading: "gasu", meaning: "Gás" },
        { word: "ギフト", reading: "gifuto", meaning: "Prenda / Presente" },
        { word: "グラフ", reading: "gurafu", meaning: "Gráfico" },
        { word: "ゲーム", reading: "geemu", meaning: "Jogo" },
        { word: "ゴルフ", reading: "gorufu", meaning: "Golfe" },
        { word: "ガラス", reading: "garasu", meaning: "Vidro" },
        { word: "ギター", reading: "gitaa", meaning: "Guitarra" },
        { word: "ガイド", reading: "gaido", meaning: "Guia" },
        { word: "グラス", reading: "gurasu", meaning: "Copo (de vidro)" },
        { word: "ゴリラ", reading: "gorira", meaning: "Gorila" }
    ],

    L12: [
        { word: "ゼロ", reading: "zero", meaning: "Zero" },
        { word: "ジーンズ", reading: "jiinzu", meaning: "Calças de ganga (jeans)" },
        { word: "ズボン", reading: "zubon", meaning: "Calças" },
        { word: "クイズ", reading: "kuizu", meaning: "Quiz" },
        { word: "ゾンビ", reading: "zonbi", meaning: "Zumbi" },
        { word: "サイズ", reading: "saizu", meaning: "Tamanho" },
        { word: "ズーム", reading: "zuumu", meaning: "Zoom" },
        { word: "ゼリー", reading: "zerii", meaning: "Gelatina" },
        { word: "リゾート", reading: "rizooto", meaning: "Resort" },
        { word: "デザート", reading: "dezaato", meaning: "Sobremesa" }
    ],

    L13: [
        { word: "ドア", reading: "doa", meaning: "Porta" },
        { word: "ドル", reading: "doru", meaning: "Dólar" },
        { word: "ダンス", reading: "dansu", meaning: "Dança" },
        { word: "デート", reading: "deeto", meaning: "Encontro (date)" },
        { word: "サラダ", reading: "sarada", meaning: "Salada" },
        { word: "カード", reading: "kaado", meaning: "Cartão" },
        { word: "デザイン", reading: "dezain", meaning: "Design" },
        { word: "ドリンク", reading: "dorinku", meaning: "Bebida" },
        { word: "ドライブ", reading: "doraibu", meaning: "Dirigir (passeio de carro)" },
        { word: "デパート", reading: "depaato", meaning: "Loja de departamentos" }
    ],

    L14: [
        { word: "バス", reading: "basu", meaning: "Autocarro (ônibus)" },
        { word: "ベル", reading: "beru", meaning: "Sino" },
        { word: "バター", reading: "bataa", meaning: "Manteiga" },
        { word: "テレビ", reading: "terebi", meaning: "Televisão" },
        { word: "バイト", reading: "baito", meaning: "Trabalho de meio período" },
        { word: "ボール", reading: "booru", meaning: "Bola" },
        { word: "ビデオ", reading: "bideo", meaning: "Vídeo" },
        { word: "ボート", reading: "booto", meaning: "Barco" },
        { word: "バナナ", reading: "banana", meaning: "Banana" },
        { word: "ビール", reading: "biiru", meaning: "Cerveja" }
    ],

    L15: [
        { word: "パン", reading: "pan", meaning: "Pão" },
        { word: "ペア", reading: "pea", meaning: "Par" },
        { word: "ピザ", reading: "piza", meaning: "Pizza" },
        { word: "ペン", reading: "pen", meaning: "Caneta" },
        { word: "パンツ", reading: "pantsu", meaning: "Calças / Roupa de baixo" },
        { word: "ピアノ", reading: "piano", meaning: "Piano" },
        { word: "プール", reading: "puuru", meaning: "Piscina" },
        { word: "ポスト", reading: "posuto", meaning: "Caixa de correio" },
        { word: "コピー", reading: "kopii", meaning: "Cópia" },
        { word: "パソコン", reading: "pasokon", meaning: "Computador pessoal" }
    ],

    L16: [
        { word: "カップ", reading: "kappu", meaning: "Chávena (xícara)" },
        { word: "マッチ", reading: "matchi", meaning: "Fósforo / Partida" },
        { word: "ペット", reading: "petto", meaning: "Animal de estimação" },
        { word: "コップ", reading: "koppu", meaning: "Copo" },
        { word: "ロボット", reading: "robotto", meaning: "Robô" },
        { word: "チケット", reading: "chiketto", meaning: "Ingresso (bilhete)" },
        { word: "トラック", reading: "torakku", meaning: "Caminhão / Trilha" },
        { word: "ロケット", reading: "roketto", meaning: "Foguete" },
        { word: "スリッパ", reading: "surippa", meaning: "Chinelos" },
        { word: "サッカー", reading: "sakkaa", meaning: "Futebol" }
    ],

    L17: [
        { word: "ツアー", reading: "tsuaa", meaning: "Excursão (tour)" },
        { word: "コート", reading: "kooto", meaning: "Casaco / Quadra (espaço)" },
        { word: "カラー", reading: "karaa", meaning: "Cor" },
        { word: "スープ", reading: "suupu", meaning: "Sopa" },
        { word: "コーラ", reading: "koora", meaning: "Refrigerante (cola)" },
        { word: "カレー", reading: "karee", meaning: "Caril (curry)" },
        { word: "カバー", reading: "kabaa", meaning: "Capa" },
        { word: "ブーツ", reading: "buutsu", meaning: "Botas" },
        { word: "レポート", reading: "repooto", meaning: "Relatório" },
        { word: "ラグビー", reading: "ragubii", meaning: "Rugby" },
        { word: "グループ", reading: "guruupu", meaning: "Grupo" },
        { word: "ロッカー", reading: "rokkaa", meaning: "Cacifo (armário)" },
        { word: "リーダー", reading: "riidaa", meaning: "Líder" },
        { word: "ラーメン", reading: "raamen", meaning: "Lámen" },
        { word: "ソーセージ", reading: "sooseeji", meaning: "Salsicha" },
        { word: "アイスクリーム", reading: "aisukuriimu", meaning: "Gelado (sorvete)" }
    ],

    L18: [
        { word: "キャッシュ", reading: "kyasshu", meaning: "Dinheiro (em espécie)" },
        { word: "キャベツ", reading: "kyabetsu", meaning: "Repolho" },
        { word: "キャリア", reading: "kyaria", meaning: "Carreira" },
        { word: "キャンプ", reading: "kyanpu", meaning: "Acampamento" },
        { word: "バーベキュー", reading: "baabekyuu", meaning: "Churrasco (BBQ)" },
        { word: "ギャラリー", reading: "gyararii", meaning: "Galeria" },
        { word: "シャツ", reading: "shatsu", meaning: "Camisa" },
        { word: "シャーペン", reading: "shaapen", meaning: "Lapiseira" },
        { word: "シャワー", reading: "shawaa", meaning: "Chuveiro" },
        { word: "シュガー", reading: "shugaa", meaning: "Açúcar" },
        { word: "ショッピング", reading: "shoppingu", meaning: "Compras" },
        { word: "マンション", reading: "manshon", meaning: "Condomínio (ed. residência)" },
        { word: "ジャム", reading: "jamu", meaning: "Geleia" },
        { word: "ジュース", reading: "juusu", meaning: "Sumo (suco)" },
        { word: "ジョギング", reading: "jogingu", meaning: "Corrida" },
        { word: "チャンネル", reading: "channeru", meaning: "Canal" },
        { word: "チョコレート", reading: "chokoreeto", meaning: "Chocolate" },
        { word: "メニュー", reading: "menyuu", meaning: "Menu (cardápio)" },
        { word: "ニュース", reading: "nyuusu", meaning: "Notícias" },
        { word: "コンピューター", reading: "konpyuutaa", meaning: "Computador" }
    ],

    L19: [
        { word: "ウィークエンド", reading: "wiikuendo", meaning: "Fim de semana" },
        { word: "ウェブサイト", reading: "webusaito", meaning: "Website" },
        { word: "ウォーター", reading: "wootaa", meaning: "Água" },
        { word: "ヴァイオリン", reading: "vaiorin", meaning: "Violino" },
        { word: "ヴィンテージ", reading: "vinteeji", meaning: "Vintage" },
        { word: "ヴェネツィア", reading: "venetsia", meaning: "Veneza" },
        { word: "クェスチョン", reading: "kwesuchon", meaning: "Questão" },
        { word: "クォーツ", reading: "kwootsu", meaning: "Quartzo" },
        { word: "グァバ", reading: "gwaba", meaning: "Goiaba" },
        { word: "シェア", reading: "shea", meaning: "Compartilhar" },
        { word: "ジェット", reading: "jetto", meaning: "Jato" },
        { word: "チェス", reading: "chesu", meaning: "Xadrez" },
        { word: "ティー", reading: "tii", meaning: "Chá" },
        { word: "ディズニー", reading: "dizunii", meaning: "Disney" },
        { word: "ファイル", reading: "fairu", meaning: "Arquivo" },
        { word: "フィルム", reading: "firumu", meaning: "Filme" },
        { word: "フェア", reading: "fea", meaning: "Feira" },
        { word: "フォーク", reading: "fooku", meaning: "Garfo" },
        { word: "デュアル", reading: "dyuaru", meaning: "Dual" },
        { word: "フュージョン", reading: "fyuujon", meaning: "Fusão" }
    ],

    L20_1: [
        { word: "アイスランド", reading: "aisurando", meaning: "Islândia" },
        { word: "アメリカ", reading: "amerika", meaning: "Estados Unidos" },
        { word: "イギリス", reading: "igirisu", meaning: "Reino Unido" },
        { word: "イタリア", reading: "itaria", meaning: "Itália" },
        { word: "インド", reading: "indo", meaning: "Índia" },
        { word: "ウクライナ", reading: "ukuraina", meaning: "Ucrânia" },
        { word: "エジプト", reading: "ejiputo", meaning: "Egito" },
        { word: "オーストラリア", reading: "oosutoraria", meaning: "Austrália" },
        { word: "カナダ", reading: "kanada", meaning: "Canadá" },
        { word: "韓国", reading: "kankoku", meaning: "Coreia do Sul" },
        { word: "ギリシャ", reading: "girisha", meaning: "Grécia" },
        { word: "スウェーデン", reading: "suweeden", meaning: "Suécia" },
        { word: "スペイン", reading: "supein", meaning: "Espanha" },
        { word: "タイ", reading: "tai", meaning: "Tailândia" },
        { word: "チリ", reading: "chiri", meaning: "Chile" },
        { word: "中国", reading: "chuugoku", meaning: "China" },
        { word: "デンマーク", reading: "denmaaku", meaning: "Dinamarca" },
        { word: "ドイツ", reading: "doitsu", meaning: "Alemanha" },
        { word: "日本", reading: "nihon", meaning: "Japão" },
        { word: "ノルウェー", reading: "noruwee", meaning: "Noruega" },
        { word: "フィリピン", reading: "firipin", meaning: "Filipinas" },
        { word: "フィンランド", reading: "finrando", meaning: "Finlândia" },
        { word: "フランス", reading: "furansu", meaning: "França" },
        { word: "ブラジル", reading: "burajiru", meaning: "Brasil" },
        { word: "ポルトガル", reading: "porutogaru", meaning: "Portugal" },
        { word: "ロシア", reading: "roshia", meaning: "Rússia" }
    ],

    L20_2: [
        { word: "アイスランド人", reading: "aisurandojin", meaning: "Islandês" },
        { word: "アメリカ人", reading: "amerikajin", meaning: "Americano" },
        { word: "イギリス人", reading: "igirisujin", meaning: "Britânico" },
        { word: "イタリア人", reading: "itariajin", meaning: "Italiano" },
        { word: "インド人", reading: "indojin", meaning: "Indiano" },
        { word: "ウクライナ人", reading: "ukurainajin", meaning: "Ucraniano" },
        { word: "エジプト人", reading: "ejiputojin", meaning: "Egípcio" },
        { word: "オーストラリア人", reading: "oosutorariajin", meaning: "Australiano" },
        { word: "カナダ人", reading: "kanadajin", meaning: "Canadense" },
        { word: "韓国人", reading: "kankokujin", meaning: "Sul-coreano" },
        { word: "ギリシャ人", reading: "girishajin", meaning: "Grego" },
        { word: "スウェーデン人", reading: "suweedenjin", meaning: "Sueco" },
        { word: "スペイン人", reading: "supeinjin", meaning: "Espanhol" },
        { word: "タイ人", reading: "taijin", meaning: "Tailandês" },
        { word: "チリ人", reading: "chirijin", meaning: "Chileno" },
        { word: "中国人", reading: "chuugokujin", meaning: "Chinês" },
        { word: "デンマーク人", reading: "denmaakujin", meaning: "Dinamarquês" },
        { word: "ドイツ人", reading: "doitsujin", meaning: "Alemão" },
        { word: "日本人", reading: "nihonjin", meaning: "Japonês" },
        { word: "ノルウェー人", reading: "noruweejin", meaning: "Norueguês" },
        { word: "フィリピン人", reading: "firipinjin", meaning: "Filipino" },
        { word: "フィンランド人", reading: "finrandojin", meaning: "Finlandês" },
        { word: "フランス人", reading: "furansujin", meaning: "Francês" },
        { word: "ブラジル人", reading: "burajirujin", meaning: "Brasileiro" },
        { word: "ポルトガル人", reading: "porutogarujin", meaning: "Português" },
        { word: "ロシア人", reading: "roshiajin", meaning: "Russo" }
    ],

    L20_3: [
        { word: "アイスランド語", reading: "aisurandogo", meaning: "Islandês (idioma)" },
        { word: "英語", reading: "eigo", meaning: "Inglês (idioma)" },
        { word: "イタリア語", reading: "itariago", meaning: "Italiano (idioma)" },
        { word: "ヒンディー語", reading: "hindiigo", meaning: "Hindi (idioma)" },
        { word: "ウクライナ語", reading: "ukurainago", meaning: "Ucraniano (idioma)" },
        { word: "アラビア語", reading: "arabiago", meaning: "Árabe (idioma)" },
        { word: "韓国語", reading: "kankokugo", meaning: "Coreano (idioma)" },
        { word: "ギリシャ語", reading: "girishago", meaning: "Grego (idioma)" },
        { word: "スウェーデン語", reading: "suweedengo", meaning: "Sueco (idioma)" },
        { word: "タイ語", reading: "taigo", meaning: "Tailandês (idioma)" },
        { word: "スペイン語", reading: "supeingo", meaning: "Espanhol (idioma)" },
        { word: "中国語", reading: "chuugokugo", meaning: "Chinês (idioma)" },
        { word: "デンマーク語", reading: "denmaakugo", meaning: "Dinamarquês (idioma)" },
        { word: "ドイツ語", reading: "doitsugo", meaning: "Alemão (idioma)" },
        { word: "日本語", reading: "nihongo", meaning: "Japonês (idioma)" },
        { word: "ノルウェー語", reading: "noruweego", meaning: "Norueguês (idioma)" },
        { word: "タガログ語", reading: "tagarogugo", meaning: "Tagalog / Filipino (idioma)" },
        { word: "フィンランド語", reading: "finrandogo", meaning: "Finlandês (idioma)" },
        { word: "フランス語", reading: "furansugo", meaning: "Francês (idioma)" },
        { word: "ポルトガル語", reading: "porutogarugo", meaning: "Português (idioma)" },
        { word: "ロシア語", reading: "roshiago", meaning: "Russo (idioma)" }
    ]
};

const hiraganaGroups={
A:[
{char:"あ",reading:"a"},
{char:"い",reading:"i"},
{char:"う",reading:"u"},
{char:"え",reading:"e"},
{char:"お",reading:"o"}],

KA:[
{char:"か",reading:"ka"},
{char:"き",reading:"ki"},
{char:"く",reading:"ku"},
{char:"け",reading:"ke"},
{char:"こ",reading:"ko"}],

SA:[
{char:"さ",reading:"sa"},
{char:"し",reading:"shi"},
{char:"す",reading:"su"},
{char:"せ",reading:"se"},
{char:"そ",reading:"so"}],

TA:[
{char:"た",reading:"ta"},
{char:"ち",reading:"chi"},
{char:"つ",reading:"tsu"},
{char:"て",reading:"te"},
{char:"と",reading:"to"}],

NA:[
{char:"な",reading:"na"},
{char:"に",reading:"ni"},
{char:"ぬ",reading:"nu"},
{char:"ね",reading:"ne"},
{char:"の",reading:"no"}],

HA:[
{char:"は",reading:"ha"},
{char:"ひ",reading:"hi"},
{char:"ふ",reading:"fu"},
{char:"へ",reading:"he"},
{char:"ほ",reading:"ho"}],

MA:[
{char:"ま",reading:"ma"},
{char:"み",reading:"mi"},
{char:"む",reading:"mu"},
{char:"め",reading:"me"},
{char:"も",reading:"mo"}],

YA:[
{char:"や",reading:"ya"},
{char:"ゆ",reading:"yu"},
{char:"よ",reading:"yo"}],

RA:[
{char:"ら",reading:"ra"},
{char:"り",reading:"ri"},
{char:"る",reading:"ru"},
{char:"れ",reading:"re"},
{char:"ろ",reading:"ro"}],

WA:[
{char:"わ",reading:"wa"},
{char:"を",reading:"wo"},
{char:"ん",reading:"n"}],

GA:[
{char:"が",reading:"ga"},
{char:"ぎ",reading:"gi"},
{char:"ぐ",reading:"gu"},
{char:"げ",reading:"ge"},
{char:"ご",reading:"go"}],

ZA:[
{char:"ざ",reading:"za"},
{char:"じ",reading:"ji"},
{char:"ず",reading:"zu"},
{char:"ぜ",reading:"ze"},
{char:"ぞ",reading:"zo"}],

DA:[
{char:"だ",reading:"da"},
{char:"ぢ",reading:"dji"},
{char:"づ",reading:"dzu"},
{char:"で",reading:"de"},
{char:"ど",reading:"do"}],

BA:[
{char:"ば",reading:"ba"},
{char:"び",reading:"bi"},
{char:"ぶ",reading:"bu"},
{char:"べ",reading:"be"},
{char:"ぼ",reading:"bo"}],

PA:[
{char:"ぱ",reading:"pa"},
{char:"ぴ",reading:"pi"},
{char:"ぷ",reading:"pu"},
{char:"ぺ",reading:"pe"},
{char:"ぽ",reading:"po"}],

YOON:[
{char:"きゃ",reading:"kya"},
{char:"きゅ",reading:"kyu"},
{char:"きょ",reading:"kyo"},
{char:"ぎゃ",reading:"gya"},
{char:"ぎゅ",reading:"gyu"},
{char:"ぎょ",reading:"gyo"},
{char:"しゃ",reading:"sha"},
{char:"しゅ",reading:"shu"},
{char:"しょ",reading:"sho"},
{char:"じゃ",reading:"ja"},
{char:"じゅ",reading:"ju"},
{char:"じょ",reading:"jo"},
{char:"ちゃ",reading:"cha"},
{char:"ちゅ",reading:"chu"},
{char:"ちょ",reading:"cho"},
{char:"にゃ",reading:"nya"},
{char:"にゅ",reading:"nyu"},
{char:"にょ",reading:"nyo"},
{char:"ひゃ",reading:"hya"},
{char:"ひゅ",reading:"hyu"},
{char:"ひょ",reading:"hyo"},
{char:"びゃ",reading:"bya"},
{char:"びゅ",reading:"byu"},
{char:"びょ",reading:"byo"},
{char:"ぴゃ",reading:"pya"},
{char:"ぴゅ",reading:"pyu"},
{char:"ぴょ",reading:"pyo"},
{char:"みゃ",reading:"mya"},
{char:"みゅ",reading:"myu"},
{char:"みょ",reading:"myo"},
{char:"りゃ",reading:"rya"},
{char:"りゅ",reading:"ryu"},
{char:"りょ",reading:"ryo"}]
};

const katakanaGroups={
A:[
{char:"ア",reading:"a"},
{char:"イ",reading:"i"},
{char:"ウ",reading:"u"},
{char:"エ",reading:"e"},
{char:"オ",reading:"o"}],

KA:[
{char:"カ",reading:"ka"},
{char:"キ",reading:"ki"},
{char:"ク",reading:"ku"},
{char:"ケ",reading:"ke"},
{char:"コ",reading:"ko"}],

SA:[
{char:"サ",reading:"sa"},
{char:"シ",reading:"shi"},
{char:"ス",reading:"su"},
{char:"セ",reading:"se"},
{char:"ソ",reading:"so"}],

TA:[
{char:"タ",reading:"ta"},
{char:"チ",reading:"chi"},
{char:"ツ",reading:"tsu"},
{char:"テ",reading:"te"},
{char:"ト",reading:"to"}],

NA:[
{char:"ナ",reading:"na"},
{char:"ニ",reading:"ni"},
{char:"ヌ",reading:"nu"},
{char:"ネ",reading:"ne"},
{char:"ノ",reading:"no"}],

HA:[
{char:"ハ",reading:"ha"},
{char:"ヒ",reading:"hi"},
{char:"フ",reading:"fu"},
{char:"ヘ",reading:"he"},
{char:"ホ",reading:"ho"}],

MA:[
{char:"マ",reading:"ma"},
{char:"ミ",reading:"mi"},
{char:"ム",reading:"mu"},
{char:"メ",reading:"me"},
{char:"モ",reading:"mo"}],

YA:[
{char:"ヤ",reading:"ya"},
{char:"ユ",reading:"yu"},
{char:"ヨ",reading:"yo"}],

RA:[
{char:"ラ",reading:"ra"},
{char:"リ",reading:"ri"},
{char:"ル",reading:"ru"},
{char:"レ",reading:"re"},
{char:"ロ",reading:"ro"}],

WA:[
{char:"ワ",reading:"wa"},
{char:"ヲ",reading:"wo"},
{char:"ン",reading:"n"}],

GA:[
{char:"ガ",reading:"ga"},
{char:"ギ",reading:"gi"},
{char:"グ",reading:"gu"},
{char:"ゲ",reading:"ge"},
{char:"ゴ",reading:"go"}],

ZA:[
{char:"ザ",reading:"za"},
{char:"ジ",reading:"ji"},
{char:"ズ",reading:"zu"},
{char:"ゼ",reading:"ze"},
{char:"ゾ",reading:"zo"}],

DA:[
{char:"ダ",reading:"da"},
{char:"ヂ",reading:"dji"},
{char:"ヅ",reading:"dzu"},
{char:"デ",reading:"de"},
{char:"ド",reading:"do"}],

BA:[
{char:"バ",reading:"ba"},
{char:"ビ",reading:"bi"},
{char:"ブ",reading:"bu"},
{char:"ベ",reading:"be"},
{char:"ボ",reading:"bo"}],

PA:[
{char:"パ",reading:"pa"},
{char:"ピ",reading:"pi"},
{char:"プ",reading:"pu"},
{char:"ペ",reading:"pe"},
{char:"ポ",reading:"po"}],

YOON:[
{char:"キャ",reading:"kya"},
{char:"キュ",reading:"kyu"},
{char:"キョ",reading:"kyo"},
{char:"ギャ",reading:"gya"},
{char:"ギュ",reading:"gyu"},
{char:"ギョ",reading:"gyo"},
{char:"シャ",reading:"sha"},
{char:"シュ",reading:"shu"},
{char:"ショ",reading:"sho"},
{char:"ジャ",reading:"ja"},
{char:"ジュ",reading:"ju"},
{char:"ジョ",reading:"jo"},
{char:"チャ",reading:"cha"},
{char:"チュ",reading:"chu"},
{char:"チョ",reading:"cho"},
{char:"ニャ",reading:"nya"},
{char:"ニュ",reading:"nyu"},
{char:"ニョ",reading:"nyo"},
{char:"ヒャ",reading:"hya"},
{char:"ヒュ",reading:"hyu"},
{char:"ヒョ",reading:"hyo"},
{char:"ビャ",reading:"bya"},
{char:"ビュ",reading:"byu"},
{char:"ビョ",reading:"byo"},
{char:"ピャ",reading:"pya"},
{char:"ピュ",reading:"pyu"},
{char:"ピョ",reading:"pyo"},
{char:"ミャ",reading:"mya"},
{char:"ミュ",reading:"myu"},
{char:"ミョ",reading:"myo"},
{char:"リャ",reading:"rya"},
{char:"リュ",reading:"ryu"},
{char:"リョ",reading:"ryo"}],

SPE_1:[
{char:"ウィ",reading:"wi"},{char:"ウェ",reading:"we"},{char:"ウォ",reading:"wo"},
{char:"ヴァ",reading:"va"},{char:"ヴィ",reading:"vi"},{char:"ヴ",reading:"vu"},{char:"ヴェ",reading:"ve"},{char:"ヴォ",reading:"vo"},
{char:"シェ",reading:"she"},
{char:"ジェ",reading:"je"},
{char:"チェ",reading:"che"},
{char:"ティ",reading:"ti"},{char:"トゥ",reading:"tu"},
{char:"ディ",reading:"di"},{char:"ドゥ",reading:"du"},
{char:"ファ",reading:"fa"},{char:"フィ",reading:"fi"},{char:"フェ",reading:"fe"},{char:"フォ",reading:"fo"}],

SPE_2:[
{char:"クァ",reading:"kwa"},{char:"クィ",reading:"kwi"},{char:"クェ",reading:"kwe"},{char:"クォ",reading:"kwo"},
{char:"グァ",reading:"gwa"},{char:"グィ",reading:"gwi"},{char:"グェ",reading:"gwe"},{char:"グォ",reading:"gwo"},
{char:"スィ",reading:"si"},
{char:"ズィ",reading:"zi"},
{char:"ツァ",reading:"tsa"},{char:"ツィ",reading:"tsi"},{char:"ツェ",reading:"tse"},{char:"ツォ",reading:"tso"},
{char:"ヴュ",reading:"vyu"},
{char:"テュ",reading:"tyu"},
{char:"デュ",reading:"dyu"},
{char:"フュ",reading:"fyu"},{char:"フョ",reading:"fyo"}]
};

const romajiToKana={

'a':{hira:'あ',kata:'ア'},'i':{hira:'い',kata:'イ'},'u':{hira:'う',kata:'ウ'},'e':{hira:'え',kata:'エ'},'o':{hira:'お',kata:'オ'},

'ka':{hira:'か',kata:'カ'},'ki':{hira:'き',kata:'キ'},'ku':{hira:'く',kata:'ク'},'ke':{hira:'け',kata:'ケ'},'ko':{hira:'こ',kata:'コ'},

'sa':{hira:'さ',kata:'サ'},'shi':{hira:'し',kata:'シ'},'su':{hira:'す',kata:'ス'},'se':{hira:'せ',kata:'セ'},'so':{hira:'そ',kata:'ソ'},

'ta':{hira:'た',kata:'タ'},'chi':{hira:'ち',kata:'チ'},'tsu':{hira:'つ',kata:'ツ'},'te':{hira:'て',kata:'テ'},'to':{hira:'と',kata:'ト'},

'na':{hira:'な',kata:'ナ'},'ni':{hira:'に',kata:'ニ'},'nu':{hira:'ぬ',kata:'ヌ'},'ne':{hira:'ね',kata:'ネ'},'no':{hira:'の',kata:'ノ'},

'ha':{hira:'は',kata:'ハ'},'hi':{hira:'ひ',kata:'ヒ'},'fu':{hira:'ふ',kata:'フ'},'he':{hira:'へ',kata:'ヘ'},'ho':{hira:'ほ',kata:'ホ'},

'ma':{hira:'ま',kata:'マ'},'mi':{hira:'み',kata:'ミ'},'mu':{hira:'む',kata:'ム'},'me':{hira:'め',kata:'メ'},'mo':{hira:'も',kata:'モ'},

'ya':{hira:'や',kata:'ヤ'},'yu':{hira:'ゆ',kata:'ユ'},'yo':{hira:'よ',kata:'ヨ'},

'ra':{hira:'ら',kata:'ラ'},'ri':{hira:'り',kata:'リ'},'ru':{hira:'る',kata:'ル'},'re':{hira:'れ',kata:'レ'},'ro':{hira:'ろ',kata:'ロ'},

'wa':{hira:'わ',kata:'ワ'},'wo':{hira:'を',kata:'ヲ'},'n':{hira:'ん',kata:'ン'},

'ga':{hira:'が',kata:'ガ'},'gi':{hira:'ぎ',kata:'ギ'},'gu':{hira:'ぐ',kata:'グ'},'ge':{hira:'げ',kata:'ゲ'},'go':{hira:'ご',kata:'ゴ'},

'za':{hira:'ざ',kata:'ザ'},'ji':{hira:'じ',kata:'ジ'},'zu':{hira:'ず',kata:'ズ'},'ze':{hira:'ぜ',kata:'ゼ'},'zo':{hira:'ぞ',kata:'ゾ'},

'da':{hira:'だ',kata:'ダ'},'dji':{hira:'ぢ',kata:'ヂ'},'dzu':{hira:'づ',kata:'ヅ'},'de':{hira:'で',kata:'デ'},'do':{hira:'ど',kata:'ド'},

'ba':{hira:'ば',kata:'バ'},'bi':{hira:'び',kata:'ビ'},'bu':{hira:'ぶ',kata:'ブ'},'be':{hira:'べ',kata:'ベ'},'bo':{hira:'ぼ',kata:'ボ'},

'pa':{hira:'ぱ',kata:'パ'},'pi':{hira:'ぴ',kata:'ピ'},'pu':{hira:'ぷ',kata:'プ'},'pe':{hira:'ぺ',kata:'ペ'},'po':{hira:'ぽ',kata:'ポ'},

'kya':{hira:'きゃ',kata:'キャ'},'kyu':{hira:'きゅ',kata:'キュ'},'kyo':{hira:'きょ',kata:'キョ'},

'gya':{hira:'ぎゃ',kata:'ギャ'},'gyu':{hira:'ぎゅ',kata:'ギュ'},'gyo':{hira:'ぎょ',kata:'ギョ'},

'sha':{hira:'しゃ',kata:'シャ'},'shu':{hira:'しゅ',kata:'シュ'},'sho':{hira:'しょ',kata:'ショ'},

'ja':{hira:'じゃ',kata:'ジャ'},'ju':{hira:'じゅ',kata:'ジュ'},'jo':{hira:'じょ',kata:'ジョ'},

'cha':{hira:'ちゃ',kata:'チャ'},'chu':{hira:'ちゅ',kata:'チュ'},'cho':{hira:'ちょ',kata:'チョ'},

'nya':{hira:'にゃ',kata:'ニャ'},'nyu':{hira:'にゅ',kata:'ニュ'},'nyo':{hira:'にょ',kata:'ニョ'},

'hya':{hira:'ひゃ',kata:'ヒャ'},'hyu':{hira:'ひゅ',kata:'ヒュ'},'hyo':{hira:'ひょ',kata:'ヒョ'},

'bya':{hira:'びゃ',kata:'ビャ'},'byu':{hira:'びゅ',kata:'ビュ'},'byo':{hira:'びょ',kata:'ビョ'},

'pya':{hira:'ぴゃ',kata:'ピャ'},'pyu':{hira:'ぴゅ',kata:'ピュ'},'pyo':{hira:'ぴょ',kata:'ピョ'},

'mya':{hira:'みゃ',kata:'ミャ'},'myu':{hira:'みゅ',kata:'ミュ'},'myo':{hira:'みょ',kata:'ミョ'},

'rya':{hira:'りゃ',kata:'リャ'},'ryu':{hira:'りゅ',kata:'リュ'},'ryo':{hira:'りょ',kata:'リョ'}

//,'kka':{hira:'っか',kata:'ッカ'},'kki':{hira:'っき',kata:'ッキ'},'kku':{hira:'っく',kata:'ック'},'kke':{hira:'っけ',kata:'ッケ'},'kko':{hira:'っこ',kata:'ッコ'},'ssa':{hira:'ッサ',kata:'ッサ'},'sshi':{hira:'っし',kata:'ッシ'},'ssu':{hira:'っす',kata:'ッス'},'sse':{hira:'っせ',kata:'ッセ'},'sso':{hira:'っそ',kata:'ッソ'},'tta':{hira:'った',kata:'ッタ'},'tchi':{hira:'っち',kata:'ッチ'},'ttsu':{hira:'っつ',kata:'ッツ'},'tte':{hira:'って',kata:'ッテ'},'tto':{hira:'っと',kata:'ット'},'ppa':{hira:'っぱ',kata:'ッパ'},'ppi':{hira:'っぴ',kata:'ッピ'},'ppu':{hira:'っぷ',kata:'ップ'},'ppe':{hira:'っぺ',kata:'ッペ'},'ppo':{hira:'っぽ',kata:'ッポ'},'kkya':{hira:'っきゃ',kata:'っきゃ'},'kkyu':{hira:'っきゅ',kata:'っきゅ'},'kkyo':{hira:'っきょ',kata:'っきょ'},'ssha':{hira:'っしゃ',kata:'っしゃ'},'sshu':{hira:'っしゅ',kata:'っしゅ'},'ssho':{hira:'っしょ',kata:'っしょ'},'tcha':{hira:'っちゃ',kata:'っちゃ'},'tchu':{hira:'っちゅ',kata:'っちゅ'},'tcho':{hira:'っちょ',kata:'っちょ'},'ppya':{hira:'っぴゃ',kata:'っぴゃ'},'ppyu':{hira:'っぴゅ',kata:'っぴゅ'},'ppyo':{hira:'っぴょ',kata:'っぴょ'}
};


    // ===== GLOBAL & STATE MANAGEMENT =====
    let currentAppMode = 'kana'; // Default mode
    let pendingScoreUpdate = null;

    // NEW: State object to hold separate decks and progress for each mode
    let appState = {
        kana: {
            deck: [],
            currentItem: null,
            correctCount: 0,
            incorrectCount: 0,
        },
        vocab: {
            deck: [],
            currentItem: null,
            correctCount: 0,
            incorrectCount: 0,
        },
        random: {
            deck: [], // Not really used but good for consistency
            currentItem: null,
            correctCount: 0,
            incorrectCount: 0,
        }
    };

    // ===== DOM ELEMENTS =====
    // Shared
    const promptDisplay = document.getElementById("promptDisplay");
    const meaningDisplay = document.getElementById("meaningDisplay");
    const answerBox = document.getElementById("answerBox");
    const checkBtn = document.getElementById("checkBtn");
    const nextBtn = document.getElementById("nextBtn");
    const resetBtn = document.getElementById("resetBtn");
    const remainingCount = document.getElementById("remainingCount");
    const correctDisplay = document.getElementById("correctCount");
    const incorrectDisplay = document.getElementById("incorrectCount");
    const resultDisplay = document.getElementById("resultDisplay");
    
    // Master mode selectors
    const appModeRadios = document.querySelectorAll('input[name="appMode"]');
    const vocabControls = document.getElementById('vocab-controls');
    const kanaControls = document.getElementById('kana-controls');

    // Vocabulary specific
    const vocabScriptRadios = document.querySelectorAll('input[name="vocabScript"]');
    const showAllBtn1 = document.getElementById("showAllBtn1");
    const showAllBtn2 = document.getElementById("showAllBtn2");
    const allWordsContainer1 = document.getElementById("allWordsContainer1");
    const allWordsContainer2 = document.getElementById("allWordsContainer2");

    // Kana specific
    const kanaScriptRadios = document.querySelectorAll('input[name="kanaScript"]');
    const optionsBtn1 = document.getElementById("optionsBtn1");
    const optionsBtn2 = document.getElementById("optionsBtn2");
    const optionsPanel1 = document.getElementById("options1");
    const optionsPanel2 = document.getElementById("options2");
    const correctBtn = document.getElementById("correctBtn");
    const incorrectBtn = document.getElementById("incorrectBtn");
    const checkAllHira = document.getElementById("checkAllHira");
    const groupCheckboxesHira = document.querySelectorAll(".group-checkbox-hira");
    const checkAllKata = document.getElementById("checkAllKata");
    const groupCheckboxesKata = document.querySelectorAll(".group-checkbox-kata");
    const checkAllWordsHira = document.getElementById("checkAllWordsHira");
    const groupCheckboxesWordsHira = document.querySelectorAll(".group-checkbox-words-hira");
    const checkAllWordsKata = document.getElementById("checkAllWordsKata");
    const groupCheckboxesWordsKata = document.querySelectorAll(".group-checkbox-words-kata");

    // ===== CORE MERGED FUNCTIONS =====

    // MODIFIED: Builds a deck for a specific mode and returns it, instead of modifying a global variable.
    function buildDeck(mode) {
        let newDeck = [];
        if (mode === 'vocab') {
            for (const key in hiraganaWords) {
                if (document.getElementById('wrd' + key)?.checked) {
                    newDeck.push(...hiraganaWords[key]);
                }
            }
            for (const key in katakanaWords) {
                if (document.getElementById('wrd' + key + '_kata')?.checked) {
                    newDeck.push(...katakanaWords[key]);
                }
            }
        } else if (mode === 'kana') {
            for (const key in hiraganaGroups) {
                if (document.getElementById('grp' + key)?.checked) {
                    const items = hiraganaGroups[key].map(item => ({ ...item, type: 'Hiragana' }));
                    newDeck.push(...items);
                }
            }
            for (const key in katakanaGroups) {
                if (document.getElementById('grp' + key + '_kata')?.checked) {
                    const items = katakanaGroups[key].map(item => ({ ...item, type: 'Katakana' }));
                    newDeck.push(...items);
                }
            }
        }
        return newDeck;
    }

    // MODIFIED: Now works with the state object for the current mode.
    function nextItem() {
        // NEW: Apply any pending score update first
        if (pendingScoreUpdate) {
            const stateToUpdate = appState[pendingScoreUpdate.mode];
            if (pendingScoreUpdate.result === 'correct') {
                stateToUpdate.correctCount++;
            } else {
                stateToUpdate.incorrectCount++;
            }
            // Update the display now that the score is committed
            correctDisplay.textContent = stateToUpdate.correctCount;
            incorrectDisplay.textContent = stateToUpdate.incorrectCount;

            // Clear the pending update
            pendingScoreUpdate = null;
        }

        const state = appState[currentAppMode]; // Get current mode's state

        if (currentAppMode === 'random') {
            state.currentItem = generateRandomSyllableWord(4);
            displayCurrentItem();
            updateRemaining();
            resetUIState();
            return;
        }
        
        if (state.deck.length === 0) {


        const idx = Math.floor(Math.random() * state.deck.length);
        state.currentItem = state.deck.splice(idx, 1)[0];

        updateRemaining();
        resetUIState();


            showEndScreen(currentAppMode === 'vocab' ? 'Seleciona as lições e pressiona "Reiniciar" para começar!' : 'Seleciona as linhas e pressiona "Reiniciar" para começar!');
            return;
        }

        const idx = Math.floor(Math.random() * state.deck.length);
        state.currentItem = state.deck.splice(idx, 1)[0];
        
        if(currentAppMode === 'kana') {
            state.currentItem.word = state.currentItem.char;
        }

        displayCurrentItem();
        updateRemaining();
        resetUIState();
    }
    
    // MODIFIED: Now works with the state object.
    function checkAnswer() {
        const state = appState[currentAppMode];
    const isKanaReverse = currentAppMode === 'kana' && document.querySelector('input[name="kanaScript"]:checked').value === 'reverse';

        if (checkBtn.disabled || !state.currentItem) return;

    // NEW LOGIC BLOCK for the "Reveal" button
    if (isKanaReverse) {

        displayCurrentItem(true); // Reveal the kana character
        resultDisplay.textContent = 'Resposta Correta';
        resultDisplay.className = "neutral";
        
        checkBtn.disabled = true; // Disable "Reveal" button
        correctBtn.disabled = false; // Enable scoring buttons
        incorrectBtn.disabled = false;
        correctBtn.focus(); // Focus on the 'Correct' button
        return; // Stop the function here for this mode
    }

        const userAnswer = answerBox.value.trim().toLowerCase();
        const correctAnswer = state.currentItem.reading;
        
        if (userAnswer === correctAnswer) {
            resultDisplay.textContent = "✅ Correto!";
            resultDisplay.className = "correct";
            // Set the pending update instead of changing the score
            pendingScoreUpdate = { mode: currentAppMode, result: 'correct' };
        } else {
            resultDisplay.textContent = `❌ Incorreto! A resposta era: ${correctAnswer}`;
            resultDisplay.className = "incorrect";
            // Set the pending update instead of changing the score
            pendingScoreUpdate = { mode: currentAppMode, result: 'incorrect' };
        }

        displayCurrentItem(true); // Reveal answer after checking
        checkBtn.disabled = true;
        nextBtn.disabled = false;
        answerBox.focus();
    }

    // MODIFIED: This now resets ONLY the current mode's deck and stats.
    function resetGame() {
        pendingScoreUpdate = null; // Discard any unconfirmed answer
        const state = appState[currentAppMode];
        state.correctCount = 0;
        state.incorrectCount = 0;
        state.currentItem = null;
        
        correctDisplay.textContent = 0;
        incorrectDisplay.textContent = 0;
        
        allWordsContainer1.style.display = 'none';
        allWordsContainer2.style.display = 'none';
        optionsPanel1.style.display = 'none';
        optionsPanel2.style.display = 'none';
        
        if (currentAppMode !== 'random') {
            state.deck = buildDeck(currentAppMode);
            // Update the word list display if it needs to be shown
            if(currentAppMode === 'vocab') toggleAllWords1();
            if(currentAppMode === 'kana') toggleAllWords2();
        }
        
        nextItem();
    }

    // ===== HELPER & UI FUNCTIONS =====
    
    // NEW: Function to handle switching between main modes
    function switchMode(newMode) {
        pendingScoreUpdate = null; // Discard any unconfirmed answer
        currentAppMode = newMode;
        const state = appState[currentAppMode];

            updateUIVisibility();

            displayCurrentItem();
            updateStats();
            resetUIState();

        if (state.deck.length === 0 && currentAppMode !== 'random') {
        showEndScreen(currentAppMode === 'vocab' ? 'Seleciona as lições e pressiona "Reiniciar" para começar!' : 'Seleciona as linhas e pressiona "Reiniciar" para começar!');
        return;
        }
    }

    function boot(newMode) {
        currentAppMode = newMode;
            resetGame();
            updateUIVisibility();
            displayCurrentItem();
            updateStats();
            resetUIState();
    }

function handleSelfScore(isCorrect) {
    const state = appState.kana; // This mode only exists for Kana
    if (isCorrect) {
        state.correctCount++;
    } else {
        state.incorrectCount++;
    }
    // Update the score display immediately
    correctDisplay.textContent = state.correctCount;
    incorrectDisplay.textContent = state.incorrectCount;
    
    // Move to the next item
    nextItem();
}
    
    // NEW: A dedicated function to update the display based on the current item.
    // 'reveal' parameter is used for showing the answer after checking.
    function displayCurrentItem(reveal = false) {
        const state = appState[currentAppMode];
        if (!state.currentItem) {
            promptDisplay.textContent = '?';
            meaningDisplay.textContent = '...';
            return;
        }
        
        if (currentAppMode === 'vocab') {
            const vocabMode = document.querySelector('input[name="vocabScript"]:checked').value;
            if (vocabMode === 'normal') {
                promptDisplay.textContent = state.currentItem.word;
                meaningDisplay.textContent = reveal ? state.currentItem.meaning : "...";
            } else { // alt mode
                promptDisplay.textContent = reveal ? state.currentItem.word : "...";
                meaningDisplay.textContent = state.currentItem.meaning;
            }
        } else if (currentAppMode === 'kana') {
            const kanaMode = document.querySelector('input[name="kanaScript"]:checked').value;
            if (kanaMode === 'reverse') {
                promptDisplay.textContent = reveal ? state.currentItem.word : state.currentItem.reading;
                meaningDisplay.textContent = `(${state.currentItem.type})`;
            } else { // normal mode
                promptDisplay.textContent = state.currentItem.word;
                meaningDisplay.textContent = "";
            }
        } else if (currentAppMode === 'random') {
            promptDisplay.textContent = state.currentItem.word;
            meaningDisplay.textContent = "";
        }
    }
    
    // NEW: Updates the score display from the current mode's state.
    function updateStats() {
        const state = appState[currentAppMode];
        correctDisplay.textContent = state.correctCount;
        incorrectDisplay.textContent = state.incorrectCount;
        updateRemaining();
    }
    
    // MODIFIED: This logic is now cleaner and separated by mode.
    function updateUIVisibility() {
        vocabControls.style.display = 'none';
        kanaControls.style.display = 'none';
        
        if (currentAppMode === 'vocab') {
            vocabControls.style.display = 'block';
            meaningDisplay.style.display = 'block';
            answerCounters.style.display = 'inline-block';
            answerBox.style.display = 'inline-block';
            answerBox.placeholder = "Romaji";
            answerBox.maxLength = 30;
            correctBtn.style.display = 'none';
            incorrectBtn.style.display = 'none';
            nextBtn.style.display = 'inline-block';
} else if (currentAppMode === 'kana') {
    kanaControls.style.display = 'block';
    const kanaMode = document.querySelector('input[name="kanaScript"]:checked').value;

    if (kanaMode === 'reverse') {
        // --- Inverted Kana Mode UI ---
        meaningDisplay.style.display = 'block';
        answerCounters.style.display = 'inline-block'; // SHOW the counters
        answerBox.style.display = 'none';              // HIDE the input box
        nextBtn.style.display = 'none';                // HIDE the normal 'Next' button
        
        checkBtn.style.display = 'inline-block';

        // SHOW our new self-scoring buttons
        correctBtn.style.display = 'inline-block';
        incorrectBtn.style.display = 'inline-block';

    } else { 
        // --- Normal Kana Mode UI ---
        meaningDisplay.style.display = 'none';
        answerCounters.style.display = 'inline-block';
        answerBox.style.display = 'inline-block';
        answerBox.placeholder = "Romaji";
        answerBox.maxLength = 4;

        // Restore default buttons
        checkBtn.style.display = 'inline-block';
        nextBtn.style.display = 'inline-block';
        correctBtn.style.display = 'none';
        incorrectBtn.style.display = 'none';
    }
        } else if (currentAppMode === 'random') {
            meaningDisplay.style.display = 'none';
            answerCounters.style.display = 'inline-block';
            answerBox.style.display = 'inline-block';
            answerBox.placeholder = "Romaji";
            answerBox.maxLength = 30;
            correctBtn.style.display = 'none';
            incorrectBtn.style.display = 'none';
            nextBtn.style.display = 'inline-block';
        }
    }

function resetUIState() {
    // --- Actions for ALL modes ---
    answerBox.value = "";
    resultDisplay.textContent = "Aguardando Resposta...";
    resultDisplay.className = "neutral";
    answerBox.disabled = false;

    // --- Mode-specific logic ---
    const isKanaReverse = currentAppMode === 'kana' && document.querySelector('input[name="kanaScript"]:checked').value === 'reverse';

    if (isKanaReverse) {
        // Logic for Kana Inverted Mode
        checkBtn.disabled = false;
        correctBtn.disabled = true;
        incorrectBtn.disabled = true;
        nextBtn.disabled = true; // Explicitly disable next button
        checkBtn.focus();
    } else {
        // Logic for ALL OTHER modes
        checkBtn.disabled = false;
        nextBtn.disabled = true;
        correctBtn.disabled = true; // Ensure score buttons are off
        incorrectBtn.disabled = true;
        answerBox.focus();
    }
}

    function showEndScreen(message) {
        promptDisplay.textContent = "Acabou!";
        if (currentAppMode === 'vocab' || currentAppMode === 'kana') meaningDisplay.textContent = "Parabéns!";
        checkBtn.disabled = true;
        nextBtn.disabled = true;
        correctBtn.disabled = true;
        incorrectBtn.disabled = true;
        answerBox.disabled = true;
        answerBox.value = "";
        resultDisplay.textContent = message;
        resultDisplay.className = "";
    }

    // MODIFIED: Works with the state object.
    function updateRemaining() {
        if (currentAppMode === 'random') {
            remainingCount.textContent = "∞";
            return;
        }
        const state = appState[currentAppMode];
        remainingCount.textContent = state.deck.length + (state.currentItem ? 1 : 0);
    }

    function handleEnterKey(e) {
        if (e.key === "Enter") {
            e.preventDefault();
            if (!checkBtn.disabled) {
                checkAnswer();
            } else if (!nextBtn.disabled) {
                nextItem();
            }
        }
    }

    function generateRandomSyllableWord(maxLength) {
        const syllables = Object.keys(romajiToKana);
        const wordLength = Math.floor(Math.random() * (maxLength - 1)) + 2;
        let generatedKana = '';
        let generatedReading = '';
        for (let i = 0; i < wordLength; i++) {
            const randomSyllable = syllables[Math.floor(Math.random() * syllables.length)];
            const kanaPair = romajiToKana[randomSyllable];
            const chosenKana = Math.random() < 0.5 ? kanaPair.hira : kanaPair.kata;
            generatedKana += chosenKana;
            generatedReading += randomSyllable + '';
        }
        return {
            word: generatedKana,
            reading: generatedReading.trim(),
        };
    }

    function showAllWords1() {
        optionsPanel1.style.display = "none";
        if (allWordsContainer1.style.display === "block") {
            allWordsContainer1.style.display = "none";
            return;
        }
        allWordsContainer1.style.display = "block";
    }

    function showAllWords2() {
        optionsPanel2.style.display = "none";
        if (allWordsContainer2.style.display === "block") {
            allWordsContainer2.style.display = "none";
            return;
        }
        allWordsContainer2.style.display = "block";
    }
    
    function toggleAllWords1() {
        allWordsContainer1.innerHTML = '';
        const sourceList = buildDeck('vocab'); // Build a temporary list to show all possible words
        const titleElement = document.createElement('h3');
        titleElement.textContent = "Lista de Palavras";
        allWordsContainer1.appendChild(titleElement);
        sourceList.forEach(item => {
            const p = document.createElement('p');
            p.innerHTML = `<strong>${item.word}</strong> (${item.reading}) - ${item.meaning}`;
            allWordsContainer1.appendChild(p);
        });
    }

    function toggleAllWords2() {
        allWordsContainer2.innerHTML = '';
        const sourceList = buildDeck('kana'); // Build a temporary list
        const titleElement = document.createElement('h3');
        titleElement.textContent = "Lista de Kana";
        allWordsContainer2.appendChild(titleElement);
        sourceList.forEach(item => {
            const p = document.createElement('p');
            p.innerHTML = `<strong>${item.char}</strong> - ${item.reading}`;
            allWordsContainer2.appendChild(p);
        });
    }

    function toggleOptionsPanel1() {
        allWordsContainer1.style.display = "none";
        optionsPanel1.style.display = (optionsPanel1.style.display === "none") ? "flex" : "none";
    }

    function toggleOptionsPanel2() {
        allWordsContainer2.style.display = "none";
        optionsPanel2.style.display = (optionsPanel2.style.display === "none") ? "flex" : "none";
    }

    // ===== EVENT LISTENERS =====
    // --- Main Controls ---
    checkBtn.addEventListener("click", checkAnswer);
    nextBtn.addEventListener("click", nextItem);
    correctBtn.addEventListener("click", () => handleSelfScore(true));
    incorrectBtn.addEventListener("click", () => handleSelfScore(false));
    resetBtn.addEventListener("click", resetGame); // This now ONLY rebuilds the current deck
    answerBox.addEventListener("keydown", handleEnterKey);

    // --- Mode Switching ---
    // MODIFIED: Now calls the new switchMode function instead of resetGame.
    appModeRadios.forEach(radio => radio.addEventListener('change', (e) => {
        switchMode(e.target.value);
    }));

    // MODIFIED: Sub-mode changes no longer reset the game. They just update the UI.
    vocabScriptRadios.forEach(radio => radio.addEventListener('change', () => {
        const state = appState[currentAppMode];

        updateUIVisibility();

        if (state.deck.length === 0 && currentAppMode !== 'random') {
        showEndScreen(currentAppMode === 'vocab' ? 'Seleciona as lições e pressiona "Reiniciar" para começar!' : 'Seleciona as linhas e pressiona "Reiniciar" para começar!');
        return;
        }

        displayCurrentItem();
        updateStats();
        resetUIState();
        pendingScoreUpdate = null;

        displayCurrentItem(); // Redisplay the same card in the new format
    }));

    kanaScriptRadios.forEach(radio => radio.addEventListener('change', () => {
        const state = appState[currentAppMode];

        updateUIVisibility();

        if (state.deck.length === 0 && currentAppMode !== 'random') {
        showEndScreen(currentAppMode === 'vocab' ? 'Seleciona as lições e pressiona "Reiniciar" para começar!' : 'Seleciona as linhas e pressiona "Reiniciar" para começar!');
        return;
        }

        displayCurrentItem();
        updateStats();
        resetUIState();
        pendingScoreUpdate = null;

        displayCurrentItem(); // Redisplay the same card in the new format
    }));

    showAllBtn1.addEventListener("click", showAllWords1);
    showAllBtn2.addEventListener("click", showAllWords2);
    optionsBtn1.addEventListener("click", toggleOptionsPanel1);
    optionsBtn2.addEventListener("click", toggleOptionsPanel2);
    
    // --- Checkbox Logic (Unchanged) ---
    checkAllHira.addEventListener('change', () => groupCheckboxesHira.forEach(checkbox => checkbox.checked = checkAllHira.checked));
    groupCheckboxesHira.forEach(checkbox => checkbox.addEventListener('change', () => checkAllHira.checked = Array.from(groupCheckboxesHira).every(cb => cb.checked)));
    checkAllKata.addEventListener('change', () => groupCheckboxesKata.forEach(checkbox => checkbox.checked = checkAllKata.checked));
    groupCheckboxesKata.forEach(checkbox => checkbox.addEventListener('change', () => checkAllKata.checked = Array.from(groupCheckboxesKata).every(cb => cb.checked)));
    checkAllWordsHira.addEventListener('change', () => groupCheckboxesWordsHira.forEach(checkbox => checkbox.checked = checkAllWordsHira.checked));
    groupCheckboxesWordsHira.forEach(checkbox => checkbox.addEventListener('change', () => checkAllWordsHira.checked = Array.from(groupCheckboxesWordsHira).every(cb => cb.checked)));
    checkAllWordsKata.addEventListener('change', () => groupCheckboxesWordsKata.forEach(checkbox => checkbox.checked = checkAllWordsKata.checked));
    groupCheckboxesWordsKata.forEach(checkbox => checkbox.addEventListener('change', () => checkAllWordsKata.checked = Array.from(groupCheckboxesWordsKata).every(cb => cb.checked)));

    // --- Initial setup ---
    boot('random');
    boot('vocab');
    boot('kana');
</script>
</body>
</html>
