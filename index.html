<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcards Vocab JP</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 30px; background-color: #f4f4f9; }
        #wordDisplay { font-size: 70px; margin: 20px; color: #333; font-family: "MS Gothic", sans-serif; }
        input[type="text"] { font-size: 20px; padding: 10px; width: 250px; text-align: center; border: 2px solid #ccc; border-radius: 5px; }
        button { font-size: 16px; margin: 5px; padding: 8px 15px; border-radius: 5px; border: none; cursor: pointer; background-color: #5c67f2; color: white; transition: background-color 0.2s; }
        #resetBtn { background: #f25c5c; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        button:hover { background: #5c67f2; border: none; color: white; }
        #resetBtn:hover { background: #f25c5c; border: none; color: white; }
        button:disabled:hover { background: #ccc; }

        .stats { margin-top: 15px; margin-bottom: 15px; font-size: 18px; color: #555; }
        .script-choice { margin-bottom: 20px; font-size: 1.2em; }
        .script-choice label { margin: 0 15px; cursor: pointer;}
        #resultDisplay { margin-top: 15px; font-size: 20px; font-weight: bold; height: 25px; }
        .neutral { color: black; }
        .correct { color: green; }
        .incorrect { color: red; }

.word-list-container {
    max-height: 400px; /* Altura máxima antes de aparecer o scroll */
    max-width: 300px;
    overflow-y: auto;  /* Adiciona scroll vertical quando necessário */
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 15px;
    margin: auto;
    margin-top: 25px;
    text-align: left;
    background-color: #fff;
    /* Começa escondido por defeito */
    display: none; 
}

.word-list-container h3 {
    margin-top: 0;
    text-align: center;
}

.word-list-container p {
    border-bottom: 1px solid #eee;
    padding-bottom: 5px;
    margin: 0 0 5px 0;
}
    </style>
</head>
<body>
    <h1>Flashcards de Vocabulário Japonês</h1>
    
    <div class="script-choice">
        <label><input type="radio" name="script" id="selectHiragana" value="hira" checked> Hiragana</label>
        <label><input type="radio" name="script" id="selectKatakana" value="kata"> Katakana</label>
        <label><input type="radio" name="script" id="selectMixed" value="mixed"> Misto</label>
        <label><input type="radio" name="script" id="selectRandom" value="random"> Aleatório</label>
    </div>

    <h2 id="meaningDisplay">...</h2>
    
    <div id="wordDisplay">?</div>
    
    <input type="text" id="answerBox" placeholder="Leitura">
    
    <div id="resultDisplay">Aguardando Resposta...</div><br>
    
    <button id="checkBtn">Verificar</button>
    <button id="nextBtn">Seguinte</button>
    <button id="resetBtn">Reniciar</button>
    
    <div class="stats">
        Restantes: <span id="remainingCount">0</span><br>
        Corretos: <span id="correctCount">0</span> | Incorretos: <span id="incorrectCount">0</span>
    </div>

<button id="showAllBtn">Ver Todas as Palavras</button>

<div id="allWordsContainer" class="word-list-container"></div>

<script>
    // Step 1: Define the word lists
    const hiraganaWords = [
        // Saudações e Frases
        { word: "おはよう", reading: "o ha yo u", meaning: "Bom dia (manhã)" },
        { word: "こんにちは", reading: "ko n ni chi wa", meaning: "Olá / Boa tarde" },
        { word: "こんばんは", reading: "ko n ba n wa", meaning: "Boa noite" },
        { word: "ありがとう", reading: "a ri ga to u", meaning: "Obrigado(a)" },
        { word: "ごめんなさい", reading: "go me n na sa i", meaning: "Desculpe" },
        { word: "さようなら", reading: "sa yo u na ra", meaning: "Adeus" },
        { word: "おねがいします", reading: "o ne ga i shi ma su", meaning: "Por favor" },
    
        // Pessoas e Família
        { word: "わたし", reading: "wa ta shi", meaning: "Eu" },
        { word: "あなた", reading: "a na ta", meaning: "Tu / Você" },
        { word: "ひと", reading: "hi to", meaning: "Pessoa" },
        { word: "ともだち", reading: "to mo da chi", meaning: "Amigo(a)" },
        { word: "がくせい", reading: "ga ku se i", meaning: "Estudante" },
        { word: "せんせい", reading: "se n se i", meaning: "Professor(a)" },
        { word: "かぞく", reading: "ka zo ku", meaning: "Família" },
    
        // Lugares
        { word: "がっこう", reading: "ga kko u", meaning: "Escola" },
        { word: "うち", reading: "u chi", meaning: "Casa" },
        { word: "えき", reading: "e ki", meaning: "Estação (de comboio)" },
        { word: "みせ", reading: "mi se", meaning: "Loja" },
        { word: "にほん", reading: "ni ho n", meaning: "Japão" },
    
        // Comida e Bebida
        { word: "ごはん", reading: "go ha n", meaning: "Arroz / Refeição" },
        { word: "さかな", reading: "sa ka na", meaning: "Peixe" },
        { word: "にく", reading: "ni ku", meaning: "Carne" },
        { word: "やさい", reading: "ya sa i", meaning: "Vegetais" },
        { word: "みず", reading: "mi zu", meaning: "Água" },
        { word: "おちゃ", reading: "o cha", meaning: "Chá" },
    
        // Animais
        { word: "いぬ", reading: "i nu", meaning: "Cão" },
        { word: "ねこ", reading: "ne ko", meaning: "Gato" },
        { word: "とり", reading: "to ri", meaning: "Pássaro" },
    
        // Objetos
        { word: "ほん", reading: "ho n", meaning: "Livro" },
        { word: "えんぴつ", reading: "e n pi tsu", meaning: "Lápis" },
        { word: "かさ", reading: "ka sa", meaning: "Guarda-chuva" },
        { word: "くつ", reading: "ku tsu", meaning: "Sapatos" },
        { word: "でんわ", reading: "de n wa", meaning: "Telefone" },
        { word: "くるま", reading: "ku ru ma", meaning: "Carro" },
    
        // Tempo e Natureza
        { word: "てんき", reading: "te n ki", meaning: "Tempo (clima)" },
        { word: "あめ", reading: "a me", meaning: "Chuva" },
        { word: "ゆき", reading: "yu ki", meaning: "Neve" },
        { word: "そら", reading: "so ra", meaning: "Céu" },
        { word: "やま", reading: "ya ma", meaning: "Montanha" },
        { word: "かわ", reading: "ka wa", meaning: "Rio" },
    
        // Datas e Tempo
        { word: "きょう", reading: "kyo u", meaning: "Hoje" },
        { word: "あした", reading: "a shi ta", meaning: "Amanhã" },
        { word: "きのう", reading: "ki no u", meaning: "Ontem" },
        { word: "いま", reading: "i ma", meaning: "Agora" },
        { word: "じかん", reading: "ji ka n", meaning: "Tempo / Hora" },
    
        // Verbos (forma de dicionário)
        { word: "たべる", reading: "ta be ru", meaning: "Comer" },
        { word: "のむ", reading: "no mu", meaning: "Beber" },
        { word: "みる", reading: "mi ru", meaning: "Ver" },
        { word: "きく", reading: "ki ku", meaning: "Ouvir / Perguntar" },
        { word: "よむ", reading: "yo mu", meaning: "Ler" },
        { word: "かく", reading: "ka ku", meaning: "Escrever" },
        { word: "いく", reading: "i ku", meaning: "Ir" },
        { word: "かう", reading: "ka u", meaning: "Comprar" },
        { word: "はなす", reading: "ha na su", meaning: "Falar" },
        { word: "する", reading: "su ru", meaning: "Fazer" },
    
        // Adjetivos
        { word: "おおきい", reading: "o o ki i", meaning: "Grande" },
        { word: "ちいさい", reading: "chi i sa i", meaning: "Pequeno" },
        { word: "あたらしい", reading: "a ta ra shi i", meaning: "Novo" },
        { word: "ふるい", reading: "fu ru i", meaning: "Velho (coisas)" },
        { word: "いい", reading: "i i", meaning: "Bom" },
        { word: "わるい", reading: "wa ru i", meaning: "Mau" },
        { word: "たかい", reading: "ta ka i", meaning: "Alto / Caro" },
        { word: "やすい", reading: "ya su i", meaning: "Barato" },
        { word: "おいしい", reading: "o i shi i", meaning: "Delicioso" },
    
        // Cores
        { word: "あか", reading: "a ka", meaning: "Vermelho" },
        { word: "あお", reading: "a o", meaning: "Azul" },
        { word: "しろ", reading: "shi ro", meaning: "Branco" },
        { word: "くろ", reading: "ku ro", meaning: "Preto" },
    
        // Números
        { word: "いち", reading: "i chi", meaning: "Um" },
        { word: "に", reading: "ni", meaning: "Dois" },
        { word: "さん", reading: "sa n", meaning: "Três" },
        { word: "よん", reading: "yo n", meaning: "Quatro" },
        { word: "ご", reading: "go", meaning: "Cinco" },
        { word: "ろく", reading: "ro ku", meaning: "Seis" },
        { word: "なな", reading: "na na", meaning: "Sete" },
        { word: "はち", reading: "ha chi", meaning: "Oito" },
        { word: "きゅう", reading: "kyu u", meaning: "Nove" },
        { word: "じゅう", reading: "ju u", meaning: "Dez" }
    ];

    const katakanaWords = [
        // Comida e Bebida
        { word: "パン", reading: "pa n", meaning: "Pão" },
        { word: "コーヒー", reading: "ko hi", meaning: "Café" },
        { word: "ジュース", reading: "ju su", meaning: "Sumo" },
        { word: "ビール", reading: "bi ru", meaning: "Cerveja" },
        { word: "ワイン", reading: "wa i n", meaning: "Vinho" },
        { word: "チーズ", reading: "chi zu", meaning: "Queijo" },
        { word: "ケーキ", reading: "ke ki", meaning: "Bolo" },
        { word: "アイスクリーム", reading: "a i su ku ri mu", meaning: "Gelado" },
        { word: "レストラン", reading: "re su to ra n", meaning: "Restaurante" },
        { word: "メニュー", reading: "me nyu", meaning: "Menu" },
    
        // Tecnologia
        { word: "テレビ", reading: "te re bi", meaning: "Televisão" },
        { word: "ラジオ", reading: "ra ji o", meaning: "Rádio" },
        { word: "パソコン", reading: "pa so ko n", meaning: "Computador Pessoal" },
        { word: "カメラ", reading: "ka me ra", meaning: "Câmara" },
        { word: "スマホ", reading: "su ma ho", meaning: "Smartphone" },
        { word: "インターネット", reading: "i n ta ne tto", meaning: "Internet" },
        { word: "Eメール", reading: "i me ru", meaning: "E-mail" },
    
        // Lugares
        { word: "アメリカ", reading: "a me ri ka", meaning: "América / EUA" },
        { word: "ブラジル", reading: "bu ra ji ru", meaning: "Brasil" },
        { word: "ポルトガル", reading: "po ru to ga ru", meaning: "Portugal" },
        { word: "ホテル", reading: "ho te ru", meaning: "Hotel" },
        { word: "スーパー", reading: "su pa", meaning: "Supermercado" },
        { word: "デパート", reading: "de pa to", meaning: "Centro Comercial" },
        { word: "トイレ", reading: "to i re", meaning: "Casa de Banho" },
    
        // Transportes
        { word: "バス", reading: "ba su", meaning: "Autocarro" },
        { word: "タクシー", reading: "ta ku shi", meaning: "Táxi" },
        { word: "バイク", reading: "ba i ku", meaning: "Mota" },
    
        // Roupas
        { word: "シャツ", reading: "sha tsu", meaning: "Camisa" },
        { word: "Tシャツ", reading: "ti sha tsu", meaning: "T-shirt" },
        { word: "ズボン", reading: "zu bo n", meaning: "Calças" },
        { word: "スカート", reading: "su ka to", meaning: "Saia" },
    
        // Desporto
        { word: "スポーツ", reading: "su po tsu", meaning: "Desporto" },
        { word: "サッカー", reading: "sa kka", meaning: "Futebol" },
        { word: "テニス", reading: "te ni su", meaning: "Ténis" },
        { word: "ゴルフ", reading: "go ru fu", meaning: "Golfe" },
    
        // Objetos Domésticos
        { word: "ドア", reading: "do a", meaning: "Porta" },
        { word: "テーブル", reading: "te bu ru", meaning: "Mesa" },
        { word: "ベッド", reading: "be ddo", meaning: "Cama" },
        { word: "ペン", reading: "pe n", meaning: "Caneta" },
        { word: "ノート", reading: "no to", meaning: "Caderno" },
    
        // Outros
        { word: "テスト", reading: "te su to", meaning: "Teste" },
        { word: "パーティー", reading: "pa ti", meaning: "Festa" },
        { word: "クラス", reading: "ku ra su", meaning: "Aula / Turma" },
        { word: "ガラス", reading: "ga ra su", meaning: "Vidro" },
        { word: "ゼロ", reading: "ze ro", meaning: "Zero" },
        { word: "アレルギー", reading: "a re ru gi", meaning: "Alergia" },
        { word: "エネルギー", reading: "e ne ru gi", meaning: "Energia" },
        { word: "ビタミン", reading: "bi ta mi n", meaning: "Vitamina" },
        { word: "ピアノ", reading: "pi a no", meaning: "Piano" },
        { word: "ギター", reading: "gi ta", meaning: "Guitarra" }
    ];

const romajiToKana = {
    // --- 1. Gojūon (The Basic 50 Sounds) ---
    'a': { hira: 'あ', kata: 'ア' }, 'i': { hira: 'い', kata: 'イ' }, 'u': { hira: 'う', kata: 'ウ' }, 'e': { hira: 'え', kata: 'エ' }, 'o': { hira: 'お', kata: 'オ' },
    'ka': { hira: 'か', kata: 'カ' }, 'ki': { hira: 'き', kata: 'キ' }, 'ku': { hira: 'く', kata: 'ク' }, 'ke': { hira: 'け', kata: 'ケ' }, 'ko': { hira: 'こ', kata: 'コ' },
    'sa': { hira: 'さ', kata: 'サ' }, 'shi': { hira: 'し', kata: 'シ' }, 'su': { hira: 'す', kata: 'ス' }, 'se': { hira: 'せ', kata: 'セ' }, 'so': { hira: 'そ', kata: 'ソ' },
    'ta': { hira: 'た', kata: 'タ' }, 'chi': { hira: 'ち', kata: 'チ' }, 'tsu': { hira: 'つ', kata: 'ツ' }, 'te': { hira: 'て', kata: 'テ' }, 'to': { hira: 'と', kata: 'ト' },
    'na': { hira: 'な', kata: 'ナ' }, 'ni': { hira: 'に', kata: 'ニ' }, 'nu': { hira: 'ぬ', kata: 'ヌ' }, 'ne': { hira: 'ね', kata: 'ネ' }, 'no': { hira: 'の', kata: 'ノ' },
    'ha': { hira: 'は', kata: 'ハ' }, 'hi': { hira: 'ひ', kata: 'ヒ' }, 'fu': { hira: 'ふ', kata: 'フ' }, 'he': { hira: 'へ', kata: 'ヘ' }, 'ho': { hira: 'ほ', kata: 'ホ' },
    'ma': { hira: 'ま', kata: 'マ' }, 'mi': { hira: 'み', kata: 'ミ' }, 'mu': { hira: 'む', kata: 'ム' }, 'me': { hira: 'め', kata: 'メ' }, 'mo': { hira: 'も', kata: 'モ' },
    'ya': { hira: 'や', kata: 'ヤ' }, 'yu': { hira: 'ゆ', kata: 'ユ' }, 'yo': { hira: 'よ', kata: 'ヨ' },
    'ra': { hira: 'ら', kata: 'ラ' }, 'ri': { hira: 'り', kata: 'リ' }, 'ru': { hira: 'る', kata: 'ル' }, 're': { hira: 'れ', kata: 'レ' }, 'ro': { hira: 'ろ', kata: 'ロ' },
    'wa': { hira: 'わ', kata: 'ワ' }, 'wo': { hira: 'を', kata: 'ヲ' }, 'n': { hira: 'ん', kata: 'ン' },

    // --- 2. Dakuten (Voiced Sounds) ---
    'ga': { hira: 'が', kata: 'ガ' }, 'gi': { hira: 'ぎ', kata: 'ギ' }, 'gu': { hira: 'ぐ', kata: 'グ' }, 'ge': { hira: 'げ', kata: 'ゲ' }, 'go': { hira: 'ご', kata: 'ゴ' },
    'za': { hira: 'ざ', kata: 'ザ' }, 'ji': { hira: 'じ', kata: 'ジ' }, 'zu': { hira: 'ず', kata: 'ズ' }, 'ze': { hira: 'ぜ', kata: 'ゼ' }, 'zo': { hira: 'ぞ', kata: 'ゾ' },
    'da': { hira: 'だ', kata: 'ダ' }, 'dji': { hira: 'ぢ', kata: 'ヂ' }, 'dzu': { hira: 'づ', kata: 'ヅ' }, 'de': { hira: 'で', kata: 'デ' }, 'do': { hira: 'ど', kata: 'ド' }, // dji/dzu for distinction
    'ba': { hira: 'ば', kata: 'バ' }, 'bi': { hira: 'び', kata: 'ビ' }, 'bu': { hira: 'ぶ', kata: 'ブ' }, 'be': { hira: 'べ', kata: 'ベ' }, 'bo': { hira: 'ぼ', kata: 'ボ' },

    // --- 3. Handakuten (Plosive Sounds) ---
    'pa': { hira: 'ぱ', kata: 'パ' }, 'pi': { hira: 'ぴ', kata: 'ピ' }, 'pu': { hira: 'ぷ', kata: 'プ' }, 'pe': { hira: 'ぺ', kata: 'ペ' }, 'po': { hira: 'ぽ', kata: 'ポ' },

    // --- 4. Yōon (Contracted Sounds) ---
    'kya': { hira: 'きゃ', kata: 'キャ' }, 'kyu': { hira: 'きゅ', kata: 'キュ' }, 'kyo': { hira: 'きょ', kata: 'キョ' },
    'gya': { hira: 'ぎゃ', kata: 'ギャ' }, 'gyu': { hira: 'ぎゅ', kata: 'ギュ' }, 'gyo': { hira: 'ぎょ', kata: 'ギョ' },
    'sha': { hira: 'しゃ', kata: 'シャ' }, 'shu': { hira: 'しゅ', kata: 'シュ' }, 'sho': { hira: 'しょ', kata: 'ショ' },
    'ja': { hira: 'じゃ', kata: 'ジャ' }, 'ju': { hira: 'じゅ', kata: 'ジュ' }, 'jo': { hira: 'じょ', kata: 'ジョ' },
    'cha': { hira: 'ちゃ', kata: 'チャ' }, 'chu': { hira: 'ちゅ', kata: 'チュ' }, 'cho': { hira: 'ちょ', kata: 'チョ' },
    'dja': { hira: 'ぢゃ', kata: 'ヂャ' }, 'dju': { hira: 'ぢゅ', kata: 'ヂュ' }, 'djo': { hira: 'ぢょ', kata: 'ヂョ' },
    'nya': { hira: 'にゃ', kata: 'ニャ' }, 'nyu': { hira: 'にゅ', kata: 'ニュ' }, 'nyo': { hira: 'にょ', kata: 'ニョ' },
    'hya': { hira: 'ひゃ', kata: 'ヒャ' }, 'hyu': { hira: 'ひゅ', kata: 'ヒュ' }, 'hyo': { hira: 'ひょ', kata: 'ヒョ' },
    'bya': { hira: 'びゃ', kata: 'ビャ' }, 'byu': { hira: 'びゅ', kata: 'ビュ' }, 'byo': { hira: 'びょ', kata: 'ビョ' },
    'pya': { hira: 'ぴゃ', kata: 'ピャ' }, 'pyu': { hira: 'ぴゅ', kata: 'ピュ' }, 'pyo': { hira: 'ぴょ', kata: 'ピョ' },
    'mya': { hira: 'みゃ', kata: 'ミャ' }, 'myu': { hira: 'みゅ', kata: 'ミュ' }, 'myo': { hira: 'みょ', kata: 'ミョ' },
    'rya': { hira: 'りゃ', kata: 'リャ' }, 'ryu': { hira: 'りゅ', kata: 'リュ' }, 'ryo': { hira: 'りょ', kata: 'リョ' },

    // --- 5. Sokuon (Doubled Consonants) ---
    'kka': { hira: 'っか', kata: 'ッカ' }, 'kki': { hira: 'っき', kata: 'ッキ' }, 'kku': { hira: 'っく', kata: 'ック' }, 'kke': { hira: 'っけ', kata: 'ッケ' }, 'kko': { hira: 'っこ', kata: 'ッコ' },
    'ssa': { hira: 'ッサ', kata: 'ッサ' }, 'sshi': { hira: 'っし', kata: 'ッシ' }, 'ssu': { hira: 'っす', kata: 'ッス' }, 'sse': { hira: 'っせ', kata: 'ッセ' }, 'sso': { hira: 'っそ', kata: 'ッソ' },
    'tta': { hira: 'った', kata: 'ッタ' }, 'tchi': { hira: 'っち', kata: 'ッチ' }, 'ttsu': { hira: 'っつ', kata: 'ッツ' }, 'tte': { hira: 'って', kata: 'ッテ' }, 'tto': { hira: 'っと', kata: 'ット' },
    'ppa': { hira: 'っぱ', kata: 'ッパ' }, 'ppi': { hira: 'っぴ', kata: 'ッピ' }, 'ppu': { hira: 'っぷ', kata: 'ップ' }, 'ppe': { hira: 'っぺ', kata: 'ッペ' }, 'ppo': { hira: 'っぽ', kata: 'ッポ' },
    // Also include yōon variants
    'kkya': { hira: 'っきゃ', kata: 'っきゃ' }, 'kkyu': { hira: 'っきゅ', kata: 'っきゅ' }, 'kkyo': { hira: 'っきょ', kata: 'っきょ' },
    'ssha': { hira: 'っしゃ', kata: 'っしゃ' }, 'sshu': { hira: 'っしゅ', kata: 'っしゅ' }, 'ssho': { hira: 'っしょ', kata: 'っしょ' },
    'tcha': { hira: 'っちゃ', kata: 'っちゃ' }, 'tchu': { hira: 'っちゅ', kata: 'っちゅ' }, 'tcho': { hira: 'っちょ', kata: 'っちょ' },
    'ppya': { hira: 'っぴゃ', kata: 'っぴゃ' }, 'ppyu': { hira: 'っぴゅ', kata: 'っぴゅ' }, 'ppyo': { hira: 'っぴょ', kata: 'っぴょ' },

    // --- 6. Extended Katakana (For Foreign Sounds) ---
    // These are primarily for katakana, hiragana equivalents are for completeness.
    //     'wi': { hira: 'うぃ', kata: 'ウィ' }, 'we': { hira: 'うぇ', kata: 'ウェ' }, 'wo': { hira: 'うぉ', kata: 'ウォ' },
    //     'va': { hira: 'ゔぁ', kata: 'ヴァ' }, 'vi': { hira: 'ゔぃ', kata: 'ヴィ' }, 'vu': { hira: 'ゔ', kata: 'ヴ' }, 've': { hira: 'ゔぇ', kata: 'ヴェ' }, 'vo': { hira: 'ゔぉ', kata: 'ヴォ' },
    //     'vya': { hira: 'ゔゃ', kata: 'ヴャ' }, 'vyu': { hira: 'ゔゅ', kata: 'ヴュ' }, 'vyo': { hira: 'ゔょ', kata: 'ヴョ' },
    //     'she': { hira: 'しぇ', kata: 'シェ' }, 'je': { hira: 'じぇ', kata: 'ジェ' },
    //     'che': { hira: 'ちぇ', kata: 'チェ' },
    //     'tsa': { hira: 'つぁ', kata: 'ツァ' }, 'tsi': { hira: 'つぃ', kata: 'ツィ' }, 'tse': { hira: 'つぇ', kata: 'ツェ' }, 'tso': { hira: 'つぉ', kata: 'ツォ' },
    //     'ti': { hira: 'てぃ', kata: 'ティ' }, 'tu': { hira: 'てぅ', kata: 'テュ' },
    //     'di': { hira: 'でぃ', kata: 'ディ' }, 'du': { hira: 'でぅ', kata: 'デュ' },
    //     'fa': { hira: 'ふぁ', kata: 'ファ' }, 'fi': { hira: 'ふぃ', kata: 'フィ' }, 'fe': { hira: 'ふぇ', kata: 'フェ' }, 'fo': { hira: 'ふぉ', kata: 'フォ' },
    //     'fya': { hira: 'ふゃ', kata: 'フャ' }, 'fyu': { hira: 'ふゅ', kata: 'フュ' }, 'fyo': { hira: 'ふょ', kata: 'フョ' },
};

    function generateMixedWord(reading) {
        const syllables = reading.split(' ');
        let mixedWord = '';
        for (const syl of syllables) {
            if (romajiToKana[syl]) {
                // Randomly choose between hiragana and katakana
                const chosenKana = Math.random() < 0.5 
                    ? romajiToKana[syl].hira 
                    : romajiToKana[syl].kata;
                mixedWord += chosenKana;
            } else {
                // If syllable not in map, just append it (fallback)
                mixedWord += syl;
            }
        }
        return mixedWord;
    }

function generateRandomSyllableWord(maxLength) {
    const syllables = Object.keys(romajiToKana);
    // Generate a random word length, e.g., between 2 and 5 syllables
    const wordLength = Math.floor(Math.random() * (maxLength - 1)) + 2; 
    
    let generatedKana = '';
    let generatedReading = '';

    for (let i = 0; i < wordLength; i++) {
        // Pick a random syllable (e.g., 'ka', 'mi', 'ryu')
        const randomSyllable = syllables[Math.floor(Math.random() * syllables.length)];
        
        // Get its kana characters from the map
        const kanaPair = romajiToKana[randomSyllable];
        
        // Randomly choose to display it as hiragana or katakana
        const chosenKana = Math.random() < 0.5 ? kanaPair.hira : kanaPair.kata;
        
        generatedKana += chosenKana;
        generatedReading += randomSyllable + ' ';
    }
    
    // Return an object that looks like our other word objects
    return {
        word: generatedKana,
        reading: generatedReading.trim(), // Remove trailing space
        meaning: "Palavra Aleatória"
    };
}

    // --- Global Variables ---
    let deck = [];
    let currentWord = null;
    let correctCount = 0;
    let incorrectCount = 0;

    // --- DOM Elements ---
    const wordDisplay = document.getElementById("wordDisplay");
    const meaningDisplay = document.getElementById("meaningDisplay");
    const answerBox = document.getElementById("answerBox");
    const checkBtn = document.getElementById("checkBtn");
    const nextBtn = document.getElementById("nextBtn");
    const resetBtn = document.getElementById("resetBtn");
    const remainingCount = document.getElementById("remainingCount");
    const correctDisplay = document.getElementById("correctCount");
    const incorrectDisplay = document.getElementById("incorrectCount");
    const resultDisplay = document.getElementById("resultDisplay");
    const selectHiragana = document.getElementById('selectHiragana');
    const selectKatakana = document.getElementById('selectKatakana');
    const selectMixed = document.getElementById('selectMixed');
    const selectRandom = document.getElementById('selectRandom');
    const showAllBtn = document.getElementById("showAllBtn");
    const allWordsContainer = document.getElementById("allWordsContainer");

    // --- Core Functions ---
    function buildDeck() {
        if (selectKatakana.checked) {
            deck = [...katakanaWords];
        } else if (selectMixed.checked) {
            // Combine both arrays for mixed mode
            deck = [...hiraganaWords, ...katakanaWords];
        } else {
            // Default to hiragana
            deck = [...hiraganaWords];
        }
        updateRemaining();
    }

    function nextWord() {
    // NEW: Handle Random Generator mode first
    if (selectRandom.checked) {
        // Generate a random word with a max length of 5 syllables
        currentWord = generateRandomSyllableWord(5);
        
        meaningDisplay.textContent = currentWord.meaning;
        wordDisplay.textContent = currentWord.word;

        // Reset UI elements
        answerBox.value = "";
        answerBox.focus();
        resultDisplay.textContent = "Aguardando Resposta...";
        resultDisplay.className = "neutral";
        checkBtn.disabled = false;
        nextBtn.disabled = true;
        answerBox.disabled = false;
        // In this mode, "remaining" is infinite, so we can hide it or show a symbol
        remainingCount.textContent = "∞"; 
        return; // Exit the function here for this mode
    }

    // This part below only runs for Hiragana, Katakana, and Mixed modes
    if (deck.length === 0) {
        meaningDisplay.textContent = "Parabéns!";
        wordDisplay.textContent = "Acabou!";
            checkBtn.disabled = true;
            nextBtn.disabled = true;
            answerBox.disabled = true;
            answerBox.value = "";
            resultDisplay.textContent = 'Pressiona "Reniciar" para começar de novo!';
            resultDisplay.className = "";
            return;
        }
        
        const idx = Math.floor(Math.random() * deck.length);
        currentWord = deck.splice(idx, 1)[0];

        meaningDisplay.textContent = "...";

        if (selectMixed.checked) {
            wordDisplay.textContent = generateMixedWord(currentWord.reading);
        } else {
            wordDisplay.textContent = currentWord.word;
        }

        answerBox.value = "";
        answerBox.focus();
        resultDisplay.textContent = "Aguardando Resposta...";
        resultDisplay.className = "neutral";
        checkBtn.disabled = false;
        nextBtn.disabled = true;
        answerBox.disabled = false;
        updateRemaining();
    }

    function checkAnswer() {
    if (checkBtn.disabled || !currentWord) return;
    
    // Get the user's answer, trim whitespace, and convert to lower case
    const userAnswer = answerBox.value.trim().toLowerCase();

    // Compare with the correct reading
    if (userAnswer === currentWord.reading) {
        correctCount++;
        resultDisplay.textContent = "✅ Correto!";
        resultDisplay.className = "correct";
    } else {
        incorrectCount++;
        // Show the correct answer
        resultDisplay.textContent = `❌ Incorreto! A resposta era: ${currentWord.reading}`;
        resultDisplay.className = "incorrect";
    }

        meaningDisplay.textContent = currentWord.meaning;    
        correctDisplay.textContent = correctCount;
        incorrectDisplay.textContent = incorrectCount;
        checkBtn.disabled = true;
        nextBtn.disabled = false;
        nextBtn.focus();
    }

    function updateRemaining() {
        remainingCount.textContent = deck.length + (currentWord ? 1 : 0);
    }

    function resetGame() {
        correctCount = 0;
        incorrectCount = 0;
        correctDisplay.textContent = 0;
        incorrectDisplay.textContent = 0;
        currentWord = null;
        buildDeck();
        nextWord();
    }

    function toggleAllWords() {
        // Se o contentor já estiver visível, esconda-o e pare a função
        if (allWordsContainer.style.display === "block") {
            allWordsContainer.style.display = "none";
            return;
        }

        // Limpa a lista anterior
        allWordsContainer.innerHTML = '';

        const isKatakana = selectKatakana.checked;
        const sourceList = isKatakana ? katakanaWords : hiraganaWords;
        const listTitle = isKatakana ? "Lista de Palavras Katakana" : "Lista de Palavras Hiragana";
    
        // Cria e adiciona um título à lista
        const titleElement = document.createElement('h3');
        titleElement.textContent = listTitle;
        allWordsContainer.appendChild(titleElement);
    
        // Percorre a lista de palavras e cria um parágrafo para cada uma
        sourceList.forEach(word => {
        const p = document.createElement('p');
            // Usamos word.reading[0] para mostrar a leitura principal
            p.innerHTML = `<strong>${word.word}</strong> - ${word.meaning}`;
            allWordsContainer.appendChild(p);
        });

        // Mostra o contentor
        allWordsContainer.style.display = "block";
    }

    // --- Event Listeners ---
    checkBtn.addEventListener("click", checkAnswer);
    nextBtn.addEventListener("click", nextWord);
    resetBtn.addEventListener("click", resetGame);
    showAllBtn.addEventListener("click", toggleAllWords);

    answerBox.addEventListener("keydown", e => {
        if (e.key === "Enter") {
            e.preventDefault(); // Prevents form submission
            if (!checkBtn.disabled) {
                checkAnswer();
            } else {
                nextWord();
            }
        }
    });

    function handleModeChange() {
        allWordsContainer.style.display = 'none';
        // Disable "Show All" button if in random mode, otherwise enable it
        showAllBtn.disabled = selectRandom.checked || selectMixed.checked;
    }
    
    selectHiragana.addEventListener('change', handleModeChange);
    selectKatakana.addEventListener('change', handleModeChange);
    selectMixed.addEventListener('change', handleModeChange);
    selectRandom.addEventListener('change', handleModeChange);

    // --- Initial setup ---
    resetGame();

</script>
</body>
</html>
